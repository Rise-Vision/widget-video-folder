if("undefined"==typeof config){var config={};"undefined"!=typeof angular&&(angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","components/rv-common-i18n/dist/locales/translation_").constant("LOCALES_SUFIX",".json"),angular.module("risevision.widget.common.storage-selector.config").value("STORAGE_MODAL","http://storage-stage-rva-test.risevision.com/modal.html"))}var RiseVision=RiseVision||{};RiseVision.VideoFolder={},RiseVision.VideoFolder=function(e){"use strict";function t(){e.rpc.call("","rsevent_done",null,p.getString("id"))}function n(){e.rpc.call("","rsevent_ready",null,p.getString("id"),!0,!0,!0,!0,!0)}function o(){v=new RiseVision.VideoFolder.Storage(g),v.init()}function i(e){f=e,V=new RiseVision.VideoFolder.FrameController,V.add(0),y=0,R=1,V.createFramePlayer(0,g,f)}function r(){}function a(){var e=V.getFrameObject(y);e&&e.pause()}function s(){var e=V.getFrameObject(y);e?e.play():(y=0===y?1:0,e=V.getFrameObject(y),e.play(),V.add(0===y?1:0),V.hide(0===y?1:0),V.createFramePlayer(0===y?1:0,g,f))}function c(t,n){Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(n)&&n.length>0&&(g=JSON.parse(n[0]),p=new e.Prefs,document.getElementById("videoContainer").style.height=p.getInt("rsH")+"px",g.width=p.getInt("rsW"),g.height=p.getInt("rsH"),b=new RiseVision.Common.Background(g),b.init(o))}function d(){V.show(0===y?1:0),V.remove(y,function(){t()})}function l(){h||(2===R?(h=!0,n()):(V.add(1),V.hide(1),R=2,V.createFramePlayer(1,g,f)))}function u(e){console.debug("video-folder::playerError()",e),h?d():V.remove(y)}function m(){a()}var g,f,y,p=null,b=null,v=null,V=null,h=!1,R=0;return{onStorageInit:i,onStorageRefresh:r,pause:a,play:s,setAdditionalParams:c,playerEnded:d,playerReady:l,playerError:u,stop:m}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Background=function(e){"use strict";function t(){setTimeout(function(){s.style.backgroundImage="url("+e.background.image.url+u+"cb="+(new Date).getTime()+")",t()},d)}function n(){a=!0,e.background.useImage&&!l&&t(),r&&"function"==typeof r&&r()}function o(){var t;s=document.getElementById("background"),c=document.getElementById("backgroundStorage"),document.body.style.background=e.background.color,s?e.background.useImage?(s.className=e.background.image.position,s.className=e.background.image.scale?s.className+" scale-to-fit":s.className,l=0!==Object.keys(e.backgroundStorage).length,l?c?(c.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.files&&e.detail.files.length>0&&(s.style.backgroundImage="url("+e.detail.files[0].url+")"),a||n()}),c.setAttribute("folder",e.backgroundStorage.folder),c.setAttribute("fileName",e.backgroundStorage.fileName),c.setAttribute("companyId",e.backgroundStorage.companyId),c.go()):console.log("Missing element with id value of 'backgroundStorage'"):(t=e.background.image.url.split("?"),u=1===t.length?"?":"&",s.style.backgroundImage="url("+e.background.image.url+")",n())):n():console.log("Missing element with id value of 'background'")}function i(e){a?e&&"function"==typeof e&&e():(e&&(r=e),o())}var r=null,a=!1,s=null,c=null,d=9e5,l=!1,u="";return{init:i}};var RiseVision=RiseVision||{};RiseVision.VideoFolder=RiseVision.VideoFolder||{},RiseVision.VideoFolder.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoFolderStorage"),o="",i="";if(t){switch(t.addEventListener("rise-storage-response",function(e){var t=[];e.detail&&e.detail.files&&e.detail.files.length>0&&(e.detail.files.forEach(function(e){t.push(e.url)}),n?(n=!1,RiseVision.VideoFolder.onStorageInit(t)):RiseVision.VideoFolder.onStorageRefresh(t))}),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("folder",e.storage.folder),e.order){case"alpha-asc":o="name",i="asc";break;case"alpha-desc":o="name",i="desc";break;case"date-asc":o="date",i="asc";break;case"date-desc":o="date",i="desc";break;case"random":o="random";break;default:o="name",i="asc"}t.setAttribute("sort",o),t.setAttribute("sortDirection",i),t.go()}}var n=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.VideoFolder=RiseVision.VideoFolder||{},RiseVision.VideoFolder.FrameController=function(){"use strict";function e(e){var t,n,o=document.getElementById(s+e);try{t=o.querySelector("iframe"),n=t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument,n.remove(),t.setAttribute("src","about:blank")}catch(i){console.debug(i)}}function t(e){var t,n;t=document.getElementById(s+e),n=document.createElement("iframe"),n.setAttribute("allowTransparency",!0),n.setAttribute("frameborder","0"),n.setAttribute("scrolling","no"),t.appendChild(n)}function n(e,t,n){var o,i=document.getElementById(s+e);o=i.querySelector("iframe"),o&&(o.onload=function(){o.onload=null;var e=o.contentWindow?o.contentWindow:o.contentDocument.document?o.contentDocument.document:o.contentDocument;e.init(t,n)},o.setAttribute("src","player.html"))}function o(e){var t,n=document.getElementById(s+e);return t=n.querySelector("iframe"),t?t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument:null}function i(e){document.getElementById(s+e).style.visibility="hidden"}function r(t,n){var o=document.getElementById(s+t);e(t),setTimeout(function(){for(;o.firstChild;)o.removeChild(o.firstChild);n&&"function"==typeof n&&n()},200)}function a(e){document.getElementById(s+e).style.visibility="visible"}var s="if_";return{add:t,createFramePlayer:n,getFrameObject:o,hide:i,remove:r,show:a}},function(e,t){"use strict";function n(){RiseVision.VideoFolder.play()}function o(){RiseVision.VideoFolder.pause()}function i(){RiseVision.VideoFolder.stop()}function r(){e.removeEventListener("polymer-ready",r),s&&""!==s&&(t.rpc.register("rscmd_play_"+s,n),t.rpc.register("rscmd_pause_"+s,o),t.rpc.register("rscmd_stop_"+s,i),t.rpc.register("rsparam_set_"+s,RiseVision.VideoFolder.setAdditionalParams),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))}var a=new t.Prefs,s=a.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("polymer-ready",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-4"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwidmFsdWUiLCJSaXNlVmlzaW9uIiwiVmlkZW9Gb2xkZXIiLCJnYWRnZXRzIiwiX2RvbmUiLCJycGMiLCJjYWxsIiwiX3ByZWZzIiwiZ2V0U3RyaW5nIiwiX3JlYWR5IiwiX2JhY2tncm91bmRSZWFkeSIsIl9zdG9yYWdlIiwiU3RvcmFnZSIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiaW5pdCIsIm9uU3RvcmFnZUluaXQiLCJ1cmxzIiwiX2N1cnJlbnRGaWxlcyIsIl9mcmFtZUNvbnRyb2xsZXIiLCJGcmFtZUNvbnRyb2xsZXIiLCJhZGQiLCJfY3VycmVudEZyYW1lIiwiX2ZyYW1lQ291bnQiLCJjcmVhdGVGcmFtZVBsYXllciIsIm9uU3RvcmFnZVJlZnJlc2giLCJwYXVzZSIsImZyYW1lT2JqIiwiZ2V0RnJhbWVPYmplY3QiLCJwbGF5IiwiaGlkZSIsInNldEFkZGl0aW9uYWxQYXJhbXMiLCJuYW1lcyIsInZhbHVlcyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsIkpTT04iLCJwYXJzZSIsIlByZWZzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiaGVpZ2h0IiwiZ2V0SW50Iiwid2lkdGgiLCJfYmFja2dyb3VuZCIsIkNvbW1vbiIsIkJhY2tncm91bmQiLCJwbGF5ZXJFbmRlZCIsInNob3ciLCJyZW1vdmUiLCJwbGF5ZXJSZWFkeSIsIl9pbml0aWFsaXplZCIsInBsYXllckVycm9yIiwiZXJyb3IiLCJjb25zb2xlIiwiZGVidWciLCJzdG9wIiwiZGF0YSIsIl9yZWZyZXNoVGltZXIiLCJzZXRUaW1lb3V0IiwiYmFja2dyb3VuZEltYWdlIiwiYmFja2dyb3VuZCIsImltYWdlIiwidXJsIiwiX3NlcGFyYXRvciIsIkRhdGUiLCJnZXRUaW1lIiwiX3JlZnJlc2hEdXJhdGlvbiIsInVzZUltYWdlIiwiX2lzU3RvcmFnZUZpbGUiLCJfY2FsbGJhY2siLCJfY29uZmlndXJlIiwic3RyIiwiYm9keSIsImNvbG9yIiwiY2xhc3NOYW1lIiwicG9zaXRpb24iLCJzY2FsZSIsIk9iamVjdCIsImtleXMiLCJiYWNrZ3JvdW5kU3RvcmFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiZGV0YWlsIiwiZmlsZXMiLCJzZXRBdHRyaWJ1dGUiLCJmb2xkZXIiLCJmaWxlTmFtZSIsImNvbXBhbnlJZCIsImdvIiwibG9nIiwic3BsaXQiLCJjYiIsInN0b3JhZ2UiLCJzb3J0Iiwic29ydERpcmVjdGlvbiIsImZvckVhY2giLCJmaWxlIiwicHVzaCIsIl9pbml0aWFsTG9hZCIsIm9yZGVyIiwiX2NsZWFyIiwiaW5kZXgiLCJpZnJhbWUiLCJmcmFtZUNvbnRhaW5lciIsIlBSRUZJWCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50V2luZG93IiwiY29udGVudERvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwicGFyYW1zIiwib25sb2FkIiwidmlzaWJpbGl0eSIsImNhbGxiYWNrIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwid2luZG93IiwicG9seW1lclJlYWR5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImlkIiwicmVnaXN0ZXIiLCJwcmVmcyIsIm9uY29udGV4dG1lbnUiLCJfZ2FxIiwiZ2EiLCJ0eXBlIiwiYXN5bmMiLCJzcmMiLCJsb2NhdGlvbiIsInByb3RvY29sIiwicyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBc0IsbUJBQVhBLFFBQXdCLENBQ2pDLEdBQUlBLFVBSW1CLG9CQUFaQyxXQUNUQSxRQUFRQyxPQUFPLG9DQUNaQyxTQUFTLGlCQUFrQix1REFDM0JBLFNBQVMsZ0JBQWlCLFNBRTdCRixRQUFRQyxPQUFPLG9EQUNaRSxNQUFNLGdCQUFpQiw0REFNOUIsR0FBSUMsWUFBYUEsY0FDakJBLFlBQVdDLGVBRVhE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QUFRRSxJQUFJcUgsU0FBUyxjQUFnQkQsRUFBSWhFLEdBRXpDdEQsRUFBUUUsSUFBSXFILFNBQVMsZUFBaUJELEVBQUl4SCxXQUFXQyxZQUFZNEIscUJBQ2pFM0IsRUFBUUUsSUFBSUMsS0FBSyxHQUFJLGNBQWUsS0FBTW1ILEdBQUssc0JBN0JuRCxHQUFJRSxHQUFRLEdBQUl4SCxHQUFRbUMsTUFDdEJtRixFQUFLRSxFQUFNbkgsVUFBVSxLQUd2QjhHLEdBQU9NLGNBQWdCLFdBQ3JCLE9BQU8sR0E0QlROLEVBQU9wQyxpQkFBaUIsZ0JBQWlCcUMsSUFFeENELE9BQVFuSCxRQUtYLElBQUkwSCxNQUFPQSxRQUVYQSxNQUFLMUIsTUFBTSxjQUFlLGtCQUMxQjBCLEtBQUsxQixNQUFNLG1CQUVYLFdBQ0UsR0FBSTJCLEdBQUt2RixTQUFTdUUsY0FBYyxTQUFXZ0IsR0FBR0MsS0FBTyxrQkFBbUJELEVBQUdFLE9BQVEsRUFDbkZGLEVBQUdHLEtBQU8sVUFBWTFGLFNBQVMyRixTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJN0YsU0FBUzhGLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFULEVBQUlNIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgLy8gdmFyaWFibGVzIGdvIGhlcmVcbiAgfTtcblxuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBhbmd1bGFyLm1vZHVsZShcInJpc2V2aXNpb24uY29tbW9uLmkxOG4uY29uZmlnXCIsIFtdKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19QUkVGSVhcIiwgXCJjb21wb25lbnRzL3J2LWNvbW1vbi1pMThuL2Rpc3QvbG9jYWxlcy90cmFuc2xhdGlvbl9cIilcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiKTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi53aWRnZXQuY29tbW9uLnN0b3JhZ2Utc2VsZWN0b3IuY29uZmlnXCIpXG4gICAgICAudmFsdWUoXCJTVE9SQUdFX01PREFMXCIsIFwiaHR0cDovL3N0b3JhZ2Utc3RhZ2UtcnZhLXRlc3QucmlzZXZpc2lvbi5jb20vbW9kYWwuaHRtbFwiKTtcbiAgfVxufVxuXG4vKiBnbG9iYWwgZ2FkZ2V0cyAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvRm9sZGVyID0ge307XG5cblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgPSAoZnVuY3Rpb24gKGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9hZGRpdGlvbmFsUGFyYW1zO1xuXG4gIHZhciBfcHJlZnMgPSBudWxsLFxuICAgIF9iYWNrZ3JvdW5kID0gbnVsbCxcbiAgICBfc3RvcmFnZSA9IG51bGwsXG4gICAgX2ZyYW1lQ29udHJvbGxlciA9IG51bGw7XG5cbiAgdmFyIF9pbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gIHZhciBfY3VycmVudEZpbGVzLCBfY3VycmVudEZyYW1lO1xuXG4gIHZhciBfZnJhbWVDb3VudCA9IDA7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2RvbmUoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfZG9uZVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIikpO1xuICB9XG5cbiAgZnVuY3Rpb24gX3JlYWR5KCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X3JlYWR5XCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSxcbiAgICAgIHRydWUsIHRydWUsIHRydWUsIHRydWUsIHRydWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2JhY2tncm91bmRSZWFkeSgpIHtcbiAgICBfc3RvcmFnZSA9IG5ldyBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLlN0b3JhZ2UoX2FkZGl0aW9uYWxQYXJhbXMpO1xuICAgIF9zdG9yYWdlLmluaXQoKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gb25TdG9yYWdlSW5pdCh1cmxzKSB7XG4gICAgX2N1cnJlbnRGaWxlcyA9IHVybHM7XG5cbiAgICBfZnJhbWVDb250cm9sbGVyID0gbmV3IFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuRnJhbWVDb250cm9sbGVyKCk7XG5cbiAgICAvLyBhZGQgdGhlIGZpcnN0IGZyYW1lIGFuZCBjcmVhdGUgaXRzIHBsYXllclxuICAgIF9mcmFtZUNvbnRyb2xsZXIuYWRkKDApO1xuICAgIF9jdXJyZW50RnJhbWUgPSAwO1xuICAgIF9mcmFtZUNvdW50ID0gMTtcbiAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDAsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGVzKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uU3RvcmFnZVJlZnJlc2goLyp1cmxzKi8pIHtcbiAgICAvL1RPRE86IGhhbmRsZSBhIHJlZnJlc2hcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIHZhciBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGZyYW1lT2JqLnBhdXNlKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICB2YXIgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICBmcmFtZU9iai5wbGF5KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHNldCBjdXJyZW50IGZyYW1lIHRvIGJlIHRoZSBvbmUgdmlzaWJsZVxuICAgICAgX2N1cnJlbnRGcmFtZSA9IChfY3VycmVudEZyYW1lID09PSAwKSA/IDEgOiAwO1xuXG4gICAgICAvLyBwbGF5IHRoZSBjdXJyZW50IGZyYW1lIHZpZGVvXG4gICAgICBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG4gICAgICBmcmFtZU9iai5wbGF5KCk7XG5cbiAgICAgIC8vIHJlLWFkZCBwcmV2aW91c2x5IHJlbW92ZWQgZnJhbWUgYW5kIGNyZWF0ZSB0aGUgcGxheWVyLCBidXQgaGlkZSB2aXNpYmlsaXR5XG4gICAgICBfZnJhbWVDb250cm9sbGVyLmFkZCgoKF9jdXJyZW50RnJhbWUgPT09IDApID8gMSA6IDApKTtcbiAgICAgIF9mcmFtZUNvbnRyb2xsZXIuaGlkZSgoKF9jdXJyZW50RnJhbWUgPT09IDApID8gMSA6IDApKTtcbiAgICAgIF9mcmFtZUNvbnRyb2xsZXIuY3JlYXRlRnJhbWVQbGF5ZXIoKChfY3VycmVudEZyYW1lID09PSAwKSA/IDEgOiAwKSwgX2FkZGl0aW9uYWxQYXJhbXMsIF9jdXJyZW50RmlsZXMpO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gc2V0QWRkaXRpb25hbFBhcmFtcyhuYW1lcywgdmFsdWVzKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZXMpICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgbmFtZXNbMF0gPT09IFwiYWRkaXRpb25hbFBhcmFtc1wiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zID0gSlNPTi5wYXJzZSh2YWx1ZXNbMF0pO1xuICAgICAgICBfcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpO1xuXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Db250YWluZXJcIikuc3R5bGUuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKSArIFwicHhcIjtcblxuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy53aWR0aCA9IF9wcmVmcy5nZXRJbnQoXCJyc1dcIik7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIik7XG5cbiAgICAgICAgLy8gY3JlYXRlIGFuZCBpbml0aWFsaXplIHRoZSBCYWNrZ3JvdW5kIGluc3RhbmNlXG4gICAgICAgIF9iYWNrZ3JvdW5kID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLkJhY2tncm91bmQoX2FkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgICBfYmFja2dyb3VuZC5pbml0KF9iYWNrZ3JvdW5kUmVhZHkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllckVuZGVkKCkge1xuICAgIF9mcmFtZUNvbnRyb2xsZXIuc2hvdygoX2N1cnJlbnRGcmFtZSA9PT0gMCkgPyAxIDogMCk7XG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgX2RvbmUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllclJlYWR5KCkge1xuICAgIGlmICghX2luaXRpYWxpemVkKSB7XG4gICAgICBpZiAoX2ZyYW1lQ291bnQgPT09IDIpIHtcbiAgICAgICAgLy8gYm90aCBmcmFtZXMgaGF2ZSBiZWVuIGNyZWF0ZWQgYW5kIGxvYWRlZCwgY2FuIG5vdGlmeSBWaWV3ZXIgd2lkZ2V0IGlzIHJlYWR5XG4gICAgICAgIF9pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIF9yZWFkeSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZmlyc3QgZnJhbWUgcGxheWVyIHdhcyBzdWNjZXNzZnVsIGFuZCByZWFkeSwgY3JlYXRlIHRoZSBzZWNvbmQgb25lIGJ1dCBoaWRlIGl0XG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIuYWRkKDEpO1xuICAgICAgICBfZnJhbWVDb250cm9sbGVyLmhpZGUoMSk7XG4gICAgICAgIF9mcmFtZUNvdW50ID0gMjtcbiAgICAgICAgX2ZyYW1lQ29udHJvbGxlci5jcmVhdGVGcmFtZVBsYXllcigxLCBfYWRkaXRpb25hbFBhcmFtcywgX2N1cnJlbnRGaWxlcyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICBjb25zb2xlLmRlYnVnKFwidmlkZW8tZm9sZGVyOjpwbGF5ZXJFcnJvcigpXCIsIGVycm9yKTtcblxuICAgIGlmICghX2luaXRpYWxpemVkKSB7XG4gICAgICAvLyBXaWRnZXQgaGFzIG5vdCBzZW50IFwicmVhZHlcIiB5ZXQgYW5kIHRoZXJlIGlzIGFuIGVycm9yIChzZXR1cCBvciBwbGF5YmFjayBvZiBmaXJzdCB2aWRlbywgZG9lc24ndCBtYXR0ZXIgd2hpY2gpXG4gICAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lKTtcblxuICAgICAgLy8gZG8gbm90aGluZyBtb3JlLCBlbnN1cmUgXCJyZWFkeVwiIGlzIG5vdCBzZW50IHRvIFZpZXdlciBzbyB0aGF0IHRoaXMgd2lkZ2V0IGNhbiBiZSBza2lwcGVkXG5cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZm9yY2Ugd2lkZ2V0IHRvIGFjdCBhcyB0aG91Z2ggdGhlIHBsYXlsaXN0IGlzIGRvbmVcbiAgICAgIHBsYXllckVuZGVkKCk7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIHBhdXNlKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwib25TdG9yYWdlSW5pdFwiOiBvblN0b3JhZ2VJbml0LFxuICAgIFwib25TdG9yYWdlUmVmcmVzaFwiOiBvblN0b3JhZ2VSZWZyZXNoLFxuICAgIFwicGF1c2VcIjogcGF1c2UsXG4gICAgXCJwbGF5XCI6IHBsYXksXG4gICAgXCJzZXRBZGRpdGlvbmFsUGFyYW1zXCI6IHNldEFkZGl0aW9uYWxQYXJhbXMsXG4gICAgXCJwbGF5ZXJFbmRlZFwiOiBwbGF5ZXJFbmRlZCxcbiAgICBcInBsYXllclJlYWR5XCI6IHBsYXllclJlYWR5LFxuICAgIFwicGxheWVyRXJyb3JcIjogcGxheWVyRXJyb3IsXG4gICAgXCJzdG9wXCI6IHN0b3BcbiAgfTtcblxufSkoZ2FkZ2V0cyk7XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLkJhY2tncm91bmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2NhbGxiYWNrID0gbnVsbCxcbiAgICBfcmVhZHkgPSBmYWxzZSxcbiAgICBfYmFja2dyb3VuZCA9IG51bGwsXG4gICAgX3N0b3JhZ2UgPSBudWxsLFxuICAgIF9yZWZyZXNoRHVyYXRpb24gPSA5MDAwMDAsIC8vIDE1IG1pbnV0ZXNcbiAgICBfaXNTdG9yYWdlRmlsZSA9IGZhbHNlLFxuICAgIF9zZXBhcmF0b3IgPSBcIlwiO1xuXG4gIC8qXG4gICAqIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX3JlZnJlc2hUaW1lcigpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uIGJhY2tncm91bmRSZWZyZXNoKCkge1xuICAgICAgX2JhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBkYXRhLmJhY2tncm91bmQuaW1hZ2UudXJsICsgX3NlcGFyYXRvciArIFwiY2I9XCIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIFwiKVwiO1xuICAgICAgX3JlZnJlc2hUaW1lcigpO1xuICAgIH0sIF9yZWZyZXNoRHVyYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gX2JhY2tncm91bmRSZWFkeSgpIHtcbiAgICBfcmVhZHkgPSB0cnVlO1xuXG4gICAgaWYgKGRhdGEuYmFja2dyb3VuZC51c2VJbWFnZSAmJiAhX2lzU3RvcmFnZUZpbGUpIHtcbiAgICAgIC8vIHN0YXJ0IHRoZSByZWZyZXNoIHBvbGwgZm9yIG5vbi1zdG9yYWdlIGJhY2tncm91bmQgaW1hZ2VcbiAgICAgIF9yZWZyZXNoVGltZXIoKTtcbiAgICB9XG5cbiAgICBpZiAoX2NhbGxiYWNrICYmIHR5cGVvZiBfY2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgX2NhbGxiYWNrKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gX2NvbmZpZ3VyZSgpIHtcbiAgICB2YXIgc3RyO1xuXG4gICAgX2JhY2tncm91bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tncm91bmRcIik7XG4gICAgX3N0b3JhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2tncm91bmRTdG9yYWdlXCIpO1xuXG4gICAgLy8gc2V0IHRoZSBkb2N1bWVudCBiYWNrZ3JvdW5kXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kID0gZGF0YS5iYWNrZ3JvdW5kLmNvbG9yO1xuXG4gICAgaWYgKF9iYWNrZ3JvdW5kKSB7XG4gICAgICBpZiAoZGF0YS5iYWNrZ3JvdW5kLnVzZUltYWdlKSB7XG4gICAgICAgIF9iYWNrZ3JvdW5kLmNsYXNzTmFtZSA9IGRhdGEuYmFja2dyb3VuZC5pbWFnZS5wb3NpdGlvbjtcbiAgICAgICAgX2JhY2tncm91bmQuY2xhc3NOYW1lID0gZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnNjYWxlID8gX2JhY2tncm91bmQuY2xhc3NOYW1lICsgXCIgc2NhbGUtdG8tZml0XCJcbiAgICAgICAgICA6IF9iYWNrZ3JvdW5kLmNsYXNzTmFtZTtcblxuICAgICAgICBfaXNTdG9yYWdlRmlsZSA9IChPYmplY3Qua2V5cyhkYXRhLmJhY2tncm91bmRTdG9yYWdlKS5sZW5ndGggIT09IDApO1xuXG4gICAgICAgIGlmICghX2lzU3RvcmFnZUZpbGUpIHtcbiAgICAgICAgICBzdHIgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2UudXJsLnNwbGl0KFwiP1wiKTtcblxuICAgICAgICAgIC8vIHN0b3JlIHRoaXMgZm9yIHRoZSByZWZyZXNoIHRpbWVyXG4gICAgICAgICAgX3NlcGFyYXRvciA9IChzdHIubGVuZ3RoID09PSAxKSA/IFwiP1wiIDogXCImXCI7XG5cbiAgICAgICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwgKyBcIilcIjtcbiAgICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKF9zdG9yYWdlKSB7XG4gICAgICAgICAgICAvLyBSaXNlIFN0b3JhZ2VcbiAgICAgICAgICAgIF9zdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsICYmIGUuZGV0YWlsLmZpbGVzICYmIGUuZGV0YWlsLmZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGUuZGV0YWlsLmZpbGVzWzBdLnVybCArIFwiKVwiO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKCFfcmVhZHkpIHtcbiAgICAgICAgICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5mb2xkZXIpO1xuICAgICAgICAgICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZmlsZU5hbWVcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5maWxlTmFtZSk7XG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5jb21wYW55SWQpO1xuICAgICAgICAgICAgX3N0b3JhZ2UuZ28oKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNaXNzaW5nIGVsZW1lbnQgd2l0aCBpZCB2YWx1ZSBvZiAnYmFja2dyb3VuZFN0b3JhZ2UnXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2JhY2tncm91bmRSZWFkeSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk1pc3NpbmcgZWxlbWVudCB3aXRoIGlkIHZhbHVlIG9mICdiYWNrZ3JvdW5kJ1wiKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoY2IpIHtcbiAgICBpZiAoIV9yZWFkeSkge1xuICAgICAgaWYgKGNiKSB7XG4gICAgICAgIF9jYWxsYmFjayA9IGNiO1xuICAgICAgfVxuXG4gICAgICBfY29uZmlndXJlKCk7XG5cbiAgICB9IGVsc2UgaWYgKGNiICYmIHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBjYigpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpbml0XCI6IGluaXRcbiAgfTtcbn07XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgPSBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyIHx8IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvRm9sZGVyLlN0b3JhZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2luaXRpYWxMb2FkID0gdHJ1ZTtcblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIHN0b3JhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvRm9sZGVyU3RvcmFnZVwiKSxcbiAgICAgIHNvcnQgPSBcIlwiLFxuICAgICAgc29ydERpcmVjdGlvbiA9IFwiXCI7XG5cbiAgICBpZiAoIXN0b3JhZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHVybHMgPSBbXTtcblxuICAgICAgaWYgKGUuZGV0YWlsICYmIGUuZGV0YWlsLmZpbGVzICYmIGUuZGV0YWlsLmZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZS5kZXRhaWwuZmlsZXMuZm9yRWFjaChmdW5jdGlvbihmaWxlKSB7XG4gICAgICAgICAgdXJscy5wdXNoKGZpbGUudXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKF9pbml0aWFsTG9hZCkge1xuICAgICAgICAgIF9pbml0aWFsTG9hZCA9IGZhbHNlO1xuXG4gICAgICAgICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5vblN0b3JhZ2VJbml0KHVybHMpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5vblN0b3JhZ2VSZWZyZXNoKHVybHMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9KTtcblxuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEuc3RvcmFnZS5jb21wYW55SWQpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZm9sZGVyXCIsIGRhdGEuc3RvcmFnZS5mb2xkZXIpO1xuXG4gICAgLy8gU29ydGluZ1xuICAgIHN3aXRjaCAoZGF0YS5vcmRlcikge1xuICAgICAgY2FzZSBcImFscGhhLWFzY1wiOlxuICAgICAgICBzb3J0ID0gXCJuYW1lXCI7XG4gICAgICAgIHNvcnREaXJlY3Rpb24gPSBcImFzY1wiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJhbHBoYS1kZXNjXCI6XG4gICAgICAgIHNvcnQgPSBcIm5hbWVcIjtcbiAgICAgICAgc29ydERpcmVjdGlvbiA9IFwiZGVzY1wiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJkYXRlLWFzY1wiOlxuICAgICAgICBzb3J0ID0gXCJkYXRlXCI7XG4gICAgICAgIHNvcnREaXJlY3Rpb24gPSBcImFzY1wiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJkYXRlLWRlc2NcIjpcbiAgICAgICAgc29ydCA9IFwiZGF0ZVwiO1xuICAgICAgICBzb3J0RGlyZWN0aW9uID0gXCJkZXNjXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInJhbmRvbVwiOlxuICAgICAgICBzb3J0ID0gXCJyYW5kb21cIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBzb3J0ID0gXCJuYW1lXCI7XG4gICAgICAgIHNvcnREaXJlY3Rpb24gPSBcImFzY1wiO1xuICAgIH1cblxuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwic29ydFwiLCBzb3J0KTtcbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcInNvcnREaXJlY3Rpb25cIiwgc29ydERpcmVjdGlvbik7XG4gICAgc3RvcmFnZS5nbygpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlb0ZvbGRlciA9IFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgfHwge307XG5cblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuRnJhbWVDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgUFJFRklYID0gXCJpZl9cIjtcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfY2xlYXIoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCksXG4gICAgICBpZnJhbWUsIGZyYW1lT2JqO1xuXG4gICAgdHJ5IHtcbiAgICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XG4gICAgICBmcmFtZU9iaiA9IChpZnJhbWUuY29udGVudFdpbmRvdykgPyBpZnJhbWUuY29udGVudFdpbmRvdyA6XG4gICAgICAgIChpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50KSA/IGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQgOiBpZnJhbWUuY29udGVudERvY3VtZW50O1xuICAgICAgZnJhbWVPYmoucmVtb3ZlKCk7XG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic3JjXCIsIFwiYWJvdXQ6YmxhbmtcIik7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKGUpO1xuICAgIH1cblxuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGFkZChpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciwgaWZyYW1lO1xuXG4gICAgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCk7XG5cbiAgICBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJhbGxvd1RyYW5zcGFyZW5jeVwiLCB0cnVlKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwiZnJhbWVib3JkZXJcIiwgXCIwXCIpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzY3JvbGxpbmdcIiwgXCJub1wiKTtcblxuICAgIGZyYW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVGcmFtZVBsYXllcihpbmRleCwgcGFyYW1zLCBmaWxlcykge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KSxcbiAgICAgIGlmcmFtZTtcblxuICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XG5cbiAgICBpZiAoaWZyYW1lKSB7XG4gICAgICBpZnJhbWUub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZnJhbWUub25sb2FkID0gbnVsbDtcblxuICAgICAgICB2YXIgZnJhbWVPYmogPSAoaWZyYW1lLmNvbnRlbnRXaW5kb3cpID8gaWZyYW1lLmNvbnRlbnRXaW5kb3cgOlxuICAgICAgICAgIChpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50KSA/IGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQgOiBpZnJhbWUuY29udGVudERvY3VtZW50O1xuXG4gICAgICAgIC8vIGluaXRpYWxpemUgYW5kIGxvYWQgdGhlIHBsYXllciBpbnNpZGUgdGhlIGlmcmFtZVxuICAgICAgICBmcmFtZU9iai5pbml0KHBhcmFtcywgZmlsZXMpO1xuICAgICAgfTtcblxuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBcInBsYXllci5odG1sXCIpO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RnJhbWVPYmplY3QoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCksXG4gICAgICBpZnJhbWU7XG5cbiAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xuXG4gICAgaWYgKGlmcmFtZSkge1xuICAgICAgcmV0dXJuIChpZnJhbWUuY29udGVudFdpbmRvdykgPyBpZnJhbWUuY29udGVudFdpbmRvdyA6XG4gICAgICAgIChpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50KSA/IGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQgOiBpZnJhbWUuY29udGVudERvY3VtZW50O1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gaGlkZShpbmRleCkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KS5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZShpbmRleCwgY2FsbGJhY2spIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCk7XG5cbiAgICBfY2xlYXIoaW5kZXgpO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyByZW1vdmUgdGhlIGlmcmFtZSBieSBjbGVhcmluZyBhbGwgZWxlbWVudHMgaW5zaWRlIGRpdiBjb250YWluZXJcbiAgICAgIHdoaWxlIChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgIGZyYW1lQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2FsbGJhY2sgJiYgdHlwZW9mIGNhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9LCAyMDApO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hvdyhpbmRleCkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KS5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGFkZDogYWRkLFxuICAgIGNyZWF0ZUZyYW1lUGxheWVyOiBjcmVhdGVGcmFtZVBsYXllcixcbiAgICBnZXRGcmFtZU9iamVjdDogZ2V0RnJhbWVPYmplY3QsXG4gICAgaGlkZTogaGlkZSxcbiAgICByZW1vdmU6IHJlbW92ZSxcbiAgICBzaG93OiBzaG93XG4gIH07XG59O1xuXG4vKiBnbG9iYWwgZ2FkZ2V0cywgUmlzZVZpc2lvbiAqL1xuXG4oZnVuY3Rpb24gKHdpbmRvdywgZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpLFxuICAgIGlkID0gcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIik7XG5cbiAgLy8gRGlzYWJsZSBjb250ZXh0IG1lbnUgKHJpZ2h0IGNsaWNrIG1lbnUpXG4gIHdpbmRvdy5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIucGxheSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLnN0b3AoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBvbHltZXJSZWFkeSgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvbHltZXItcmVhZHlcIiwgcG9seW1lclJlYWR5KTtcblxuICAgIGlmIChpZCAmJiBpZCAhPT0gXCJcIikge1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wbGF5X1wiICsgaWQsIHBsYXkpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wYXVzZV9cIiArIGlkLCBwYXVzZSk7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3N0b3BfXCIgKyBpZCwgc3RvcCk7XG5cbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNwYXJhbV9zZXRfXCIgKyBpZCwgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5zZXRBZGRpdGlvbmFsUGFyYW1zKTtcbiAgICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc3BhcmFtX2dldFwiLCBudWxsLCBpZCwgW1wiYWRkaXRpb25hbFBhcmFtc1wiXSk7XG4gICAgfVxuICB9XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2x5bWVyLXJlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTQnXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9