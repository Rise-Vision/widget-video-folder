if("undefined"==typeof config){var config={SKIN:""};"undefined"!=typeof angular&&(angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","components/rv-common-i18n/dist/locales/translation_").constant("LOCALES_SUFIX",".json"),angular.module("risevision.widget.common.storage-selector.config").value("STORAGE_MODAL","http://storage-stage-rva-test.risevision.com/modal.html"))}var RiseVision=RiseVision||{};RiseVision.VideoFolder={},RiseVision.VideoFolder=function(e){"use strict";function t(){e.rpc.call("","rsevent_done",null,p.getString("id"))}function n(){e.rpc.call("","rsevent_ready",null,p.getString("id"),!0,!0,!0,!0,!0)}function o(){v=new RiseVision.VideoFolder.Storage(g),v.init()}function i(e){f=e,V=new RiseVision.VideoFolder.FrameController,V.add(0),y=0,R=1,V.createFramePlayer(0,g,f)}function r(){}function a(){var e=V.getFrameObject(y);e&&e.pause()}function s(){var e=V.getFrameObject(y);e?e.play():(y=0===y?1:0,e=V.getFrameObject(y),e.play(),V.add(0===y?1:0),V.hide(0===y?1:0),V.createFramePlayer(0===y?1:0,g,f))}function c(t,n){Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(n)&&n.length>0&&(g=JSON.parse(n[0]),p=new e.Prefs,document.getElementById("videoContainer").style.height=p.getInt("rsH")+"px",g.width=p.getInt("rsW"),g.height=p.getInt("rsH"),b=new RiseVision.Common.Background(g),b.init(o))}function d(){V.show(0===y?1:0),V.remove(y,function(){t()})}function l(){h||(2===R?(h=!0,n()):(V.add(1),V.hide(1),R=2,V.createFramePlayer(1,g,f)))}function u(e){console.debug("video-folder::playerError()",e),h?d():V.remove(y)}function m(){a()}var g,f,y,p=null,b=null,v=null,V=null,h=!1,R=0;return{onStorageInit:i,onStorageRefresh:r,pause:a,play:s,setAdditionalParams:c,playerEnded:d,playerReady:l,playerError:u,stop:m}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Background=function(e){"use strict";function t(){setTimeout(function(){s.style.backgroundImage="url("+e.background.image.url+u+"cb="+(new Date).getTime()+")",t()},d)}function n(){a=!0,e.background.useImage&&!l&&t(),r&&"function"==typeof r&&r()}function o(){var t;s=document.getElementById("background"),c=document.getElementById("backgroundStorage"),document.body.style.background=e.background.color,s?e.background.useImage?(s.className=e.background.image.position,s.className=e.background.image.scale?s.className+" scale-to-fit":s.className,l=0!==Object.keys(e.backgroundStorage).length,l?c?(c.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.files&&e.detail.files.length>0&&(s.style.backgroundImage="url("+e.detail.files[0].url+")"),a||n()}),c.setAttribute("folder",e.backgroundStorage.folder),c.setAttribute("fileName",e.backgroundStorage.fileName),c.setAttribute("companyId",e.backgroundStorage.companyId),c.go()):console.log("Missing element with id value of 'backgroundStorage'"):(t=e.background.image.url.split("?"),u=1===t.length?"?":"&",s.style.backgroundImage="url("+e.background.image.url+")",n())):n():console.log("Missing element with id value of 'background'")}function i(e){a?e&&"function"==typeof e&&e():(e&&(r=e),o())}var r=null,a=!1,s=null,c=null,d=9e5,l=!1,u="";return{init:i}};var RiseVision=RiseVision||{};RiseVision.VideoFolder=RiseVision.VideoFolder||{},RiseVision.VideoFolder.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoFolderStorage"),o="",i="";if(t){switch(t.addEventListener("rise-storage-response",function(e){var t=[];e.detail&&e.detail.files&&e.detail.files.length>0&&(e.detail.files.forEach(function(e){t.push(e.url)}),n?(n=!1,RiseVision.VideoFolder.onStorageInit(t)):RiseVision.VideoFolder.onStorageRefresh(t))}),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("folder",e.storage.folder),e.order){case"alpha-asc":o="name",i="asc";break;case"alpha-desc":o="name",i="desc";break;case"date-asc":o="date",i="asc";break;case"date-desc":o="date",i="desc";break;case"random":o="random";break;default:o="name",i="asc"}t.setAttribute("sort",o),t.setAttribute("sortDirection",i),t.go()}}var n=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.VideoFolder=RiseVision.VideoFolder||{},RiseVision.VideoFolder.FrameController=function(){"use strict";function e(e){var t,n,o=document.getElementById(s+e);try{t=o.querySelector("iframe"),n=t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument,n.remove(),t.setAttribute("src","about:blank")}catch(i){console.debug(i)}}function t(e){var t,n;t=document.getElementById(s+e),n=document.createElement("iframe"),n.setAttribute("allowTransparency",!0),n.setAttribute("frameborder","0"),n.setAttribute("scrolling","no"),t.appendChild(n)}function n(e,t,n){var o,i=document.getElementById(s+e);o=i.querySelector("iframe"),o&&(o.onload=function(){o.onload=null;var e=o.contentWindow?o.contentWindow:o.contentDocument.document?o.contentDocument.document:o.contentDocument;e.init(t,n,config.SKIN)},o.setAttribute("src","player.html"))}function o(e){var t,n=document.getElementById(s+e);return t=n.querySelector("iframe"),t?t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument:null}function i(e){document.getElementById(s+e).style.visibility="hidden"}function r(t,n){var o=document.getElementById(s+t);e(t),setTimeout(function(){for(;o.firstChild;)o.removeChild(o.firstChild);n&&"function"==typeof n&&n()},200)}function a(e){document.getElementById(s+e).style.visibility="visible"}var s="if_";return{add:t,createFramePlayer:n,getFrameObject:o,hide:i,remove:r,show:a}},function(e,t){"use strict";function n(){RiseVision.VideoFolder.play()}function o(){RiseVision.VideoFolder.pause()}function i(){RiseVision.VideoFolder.stop()}function r(){e.removeEventListener("polymer-ready",r),s&&""!==s&&(t.rpc.register("rscmd_play_"+s,n),t.rpc.register("rscmd_pause_"+s,o),t.rpc.register("rscmd_stop_"+s,i),t.rpc.register("rsparam_set_"+s,RiseVision.VideoFolder.setAdditionalParams),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))}var a=new t.Prefs,s=a.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("polymer-ready",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-4"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiU0tJTiIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25zdGFudCIsInZhbHVlIiwiUmlzZVZpc2lvbiIsIlZpZGVvRm9sZGVyIiwiZ2FkZ2V0cyIsIl9kb25lIiwicnBjIiwiY2FsbCIsIl9wcmVmcyIsImdldFN0cmluZyIsIl9yZWFkeSIsIl9iYWNrZ3JvdW5kUmVhZHkiLCJfc3RvcmFnZSIsIlN0b3JhZ2UiLCJfYWRkaXRpb25hbFBhcmFtcyIsImluaXQiLCJvblN0b3JhZ2VJbml0IiwidXJscyIsIl9jdXJyZW50RmlsZXMiLCJfZnJhbWVDb250cm9sbGVyIiwiRnJhbWVDb250cm9sbGVyIiwiYWRkIiwiX2N1cnJlbnRGcmFtZSIsIl9mcmFtZUNvdW50IiwiY3JlYXRlRnJhbWVQbGF5ZXIiLCJvblN0b3JhZ2VSZWZyZXNoIiwicGF1c2UiLCJmcmFtZU9iaiIsImdldEZyYW1lT2JqZWN0IiwicGxheSIsImhpZGUiLCJzZXRBZGRpdGlvbmFsUGFyYW1zIiwibmFtZXMiLCJ2YWx1ZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJKU09OIiwicGFyc2UiLCJQcmVmcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImhlaWdodCIsImdldEludCIsIndpZHRoIiwiX2JhY2tncm91bmQiLCJDb21tb24iLCJCYWNrZ3JvdW5kIiwicGxheWVyRW5kZWQiLCJzaG93IiwicmVtb3ZlIiwicGxheWVyUmVhZHkiLCJfaW5pdGlhbGl6ZWQiLCJwbGF5ZXJFcnJvciIsImVycm9yIiwiY29uc29sZSIsImRlYnVnIiwic3RvcCIsImRhdGEiLCJfcmVmcmVzaFRpbWVyIiwic2V0VGltZW91dCIsImJhY2tncm91bmRJbWFnZSIsImJhY2tncm91bmQiLCJpbWFnZSIsInVybCIsIl9zZXBhcmF0b3IiLCJEYXRlIiwiZ2V0VGltZSIsIl9yZWZyZXNoRHVyYXRpb24iLCJ1c2VJbWFnZSIsIl9pc1N0b3JhZ2VGaWxlIiwiX2NhbGxiYWNrIiwiX2NvbmZpZ3VyZSIsInN0ciIsImJvZHkiLCJjb2xvciIsImNsYXNzTmFtZSIsInBvc2l0aW9uIiwic2NhbGUiLCJPYmplY3QiLCJrZXlzIiwiYmFja2dyb3VuZFN0b3JhZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImRldGFpbCIsImZpbGVzIiwic2V0QXR0cmlidXRlIiwiZm9sZGVyIiwiZmlsZU5hbWUiLCJjb21wYW55SWQiLCJnbyIsImxvZyIsInNwbGl0IiwiY2IiLCJzdG9yYWdlIiwic29ydCIsInNvcnREaXJlY3Rpb24iLCJmb3JFYWNoIiwiZmlsZSIsInB1c2giLCJfaW5pdGlhbExvYWQiLCJvcmRlciIsIl9jbGVhciIsImluZGV4IiwiaWZyYW1lIiwiZnJhbWVDb250YWluZXIiLCJQUkVGSVgiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudFdpbmRvdyIsImNvbnRlbnREb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInBhcmFtcyIsIm9ubG9hZCIsInZpc2liaWxpdHkiLCJjYWxsYmFjayIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsIndpbmRvdyIsInBvbHltZXJSZWFkeSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJpZCIsInJlZ2lzdGVyIiwicHJlZnMiLCJvbmNvbnRleHRtZW51IiwiX2dhcSIsImdhIiwidHlwZSIsImFzeW5jIiwic3JjIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUVBLEdBQXNCLG1CQUFYQSxRQUF3QixDQUNqQyxHQUFJQSxTQVFGQyxLQUFNLEdBR2Usb0JBQVpDLFdBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHVEQUMzQkEsU0FBUyxnQkFBaUIsU0FFN0JGLFFBQVFDLE9BQU8sb0RBQ1pFLE1BQU0sZ0JBQWlCLDREQU05QixHQUFJQyxZQUFhQSxj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SCxTQUFTLGVBQWlCRCxFQUFJaEcsR0FDMUN0QixFQUFRRSxJQUFJcUgsU0FBUyxjQUFnQkQsRUFBSWhFLEdBRXpDdEQsRUFBUUUsSUFBSXFILFNBQVMsZUFBaUJELEVBQUl4SCxXQUFXQyxZQUFZNEIscUJBQ2pFM0IsRUFBUUUsSUFBSUMsS0FBSyxHQUFJLGNBQWUsS0FBTW1ILEdBQUssc0JBN0JuRCxHQUFJRSxHQUFRLEdBQUl4SCxHQUFRbUMsTUFDdEJtRixFQUFLRSxFQUFNbkgsVUFBVSxLQUd2QjhHLEdBQU9NLGNBQWdCLFdBQ3JCLE9BQU8sR0E0QlROLEVBQU9wQyxpQkFBaUIsZ0JBQWlCcUMsSUFFeENELE9BQVFuSCxRQUtYLElBQUkwSCxNQUFPQSxRQUVYQSxNQUFLMUIsTUFBTSxjQUFlLGtCQUMxQjBCLEtBQUsxQixNQUFNLG1CQUVYLFdBQ0UsR0FBSTJCLEdBQUt2RixTQUFTdUUsY0FBYyxTQUFXZ0IsR0FBR0MsS0FBTyxrQkFBbUJELEVBQUdFLE9BQVEsRUFDbkZGLEVBQUdHLEtBQU8sVUFBWTFGLFNBQVMyRixTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJN0YsU0FBUzhGLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFULEVBQUlNIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgLypcbiAgICAgTk9URTogUmVsYXRpdmUgcGF0aCB0byBza2luIGZpbGUgZG9lcyBub3Qgd29yayB3aGVuIHZpZXdpbmcvdGVzdGluZyBsb2NhbGx5IHVzaW5nIFByZXZpZXcgYXBwXG5cbiAgICAgV2hlbiBuZWVkaW5nIHRvIHdvcmsgb24gc2tpbiBmaWxlIFwic2l4LnhtbFwiLCB1cGxvYWQgZmlsZSB0byBzZXJ2ZXIgYW5kIGNoYW5nZSBTS0lOIHZhbHVlIHRvIHBvaW50IHRvIHNlcnZlciBsb2NhdGlvblxuICAgICBDT1JTIHdpbGwgYmUgcmVxdWlyZWQuIEhhbmR5IENPUlMgQ2hyb21lIGV4dGVuc2lvbiBjYW4gYmUgZm91bmQgaGVyZVxuICAgICBodHRwczovL2Nocm9tZS5nb29nbGUuY29tL3dlYnN0b3JlL2RldGFpbC9hbGxvdy1jb250cm9sLWFsbG93LW9yaWdpL25sZmJtYm9qcGVhY2ZnaGtwYmpoZGRpaGxra2lsamJpP2hsPWVuXG4gICAgICovXG4gICAgU0tJTjogXCJcIlxuICB9O1xuXG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi5jb21tb24uaTE4bi5jb25maWdcIiwgW10pXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImNvbXBvbmVudHMvcnYtY29tbW9uLWkxOG4vZGlzdC9sb2NhbGVzL3RyYW5zbGF0aW9uX1wiKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19TVUZJWFwiLCBcIi5qc29uXCIpO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJyaXNldmlzaW9uLndpZGdldC5jb21tb24uc3RvcmFnZS1zZWxlY3Rvci5jb25maWdcIilcbiAgICAgIC52YWx1ZShcIlNUT1JBR0VfTU9EQUxcIiwgXCJodHRwOi8vc3RvcmFnZS1zdGFnZS1ydmEtdGVzdC5yaXNldmlzaW9uLmNvbS9tb2RhbC5odG1sXCIpO1xuICB9XG59XG5cbi8qIGdsb2JhbCBnYWRnZXRzICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgPSB7fTtcblxuUmlzZVZpc2lvbi5WaWRlb0ZvbGRlciA9IChmdW5jdGlvbiAoZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2FkZGl0aW9uYWxQYXJhbXM7XG5cbiAgdmFyIF9wcmVmcyA9IG51bGwsXG4gICAgX2JhY2tncm91bmQgPSBudWxsLFxuICAgIF9zdG9yYWdlID0gbnVsbCxcbiAgICBfZnJhbWVDb250cm9sbGVyID0gbnVsbDtcblxuICB2YXIgX2luaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgdmFyIF9jdXJyZW50RmlsZXMsIF9jdXJyZW50RnJhbWU7XG5cbiAgdmFyIF9mcmFtZUNvdW50ID0gMDtcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfZG9uZSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9kb25lXCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSk7XG4gIH1cblxuICBmdW5jdGlvbiBfcmVhZHkoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfcmVhZHlcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpLFxuICAgICAgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBfYmFja2dyb3VuZFJlYWR5KCkge1xuICAgIF9zdG9yYWdlID0gbmV3IFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuU3RvcmFnZShfYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgX3N0b3JhZ2UuaW5pdCgpO1xuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBvblN0b3JhZ2VJbml0KHVybHMpIHtcbiAgICBfY3VycmVudEZpbGVzID0gdXJscztcblxuICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBuZXcgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5GcmFtZUNvbnRyb2xsZXIoKTtcblxuICAgIC8vIGFkZCB0aGUgZmlyc3QgZnJhbWUgYW5kIGNyZWF0ZSBpdHMgcGxheWVyXG4gICAgX2ZyYW1lQ29udHJvbGxlci5hZGQoMCk7XG4gICAgX2N1cnJlbnRGcmFtZSA9IDA7XG4gICAgX2ZyYW1lQ291bnQgPSAxO1xuICAgIF9mcmFtZUNvbnRyb2xsZXIuY3JlYXRlRnJhbWVQbGF5ZXIoMCwgX2FkZGl0aW9uYWxQYXJhbXMsIF9jdXJyZW50RmlsZXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25TdG9yYWdlUmVmcmVzaCgvKnVybHMqLykge1xuICAgIC8vVE9ETzogaGFuZGxlIGEgcmVmcmVzaFxuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgdmFyIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcblxuICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgZnJhbWVPYmoucGF1c2UoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIHZhciBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGZyYW1lT2JqLnBsYXkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc2V0IGN1cnJlbnQgZnJhbWUgdG8gYmUgdGhlIG9uZSB2aXNpYmxlXG4gICAgICBfY3VycmVudEZyYW1lID0gKF9jdXJyZW50RnJhbWUgPT09IDApID8gMSA6IDA7XG5cbiAgICAgIC8vIHBsYXkgdGhlIGN1cnJlbnQgZnJhbWUgdmlkZW9cbiAgICAgIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcbiAgICAgIGZyYW1lT2JqLnBsYXkoKTtcblxuICAgICAgLy8gcmUtYWRkIHByZXZpb3VzbHkgcmVtb3ZlZCBmcmFtZSBhbmQgY3JlYXRlIHRoZSBwbGF5ZXIsIGJ1dCBoaWRlIHZpc2liaWxpdHlcbiAgICAgIF9mcmFtZUNvbnRyb2xsZXIuYWRkKCgoX2N1cnJlbnRGcmFtZSA9PT0gMCkgPyAxIDogMCkpO1xuICAgICAgX2ZyYW1lQ29udHJvbGxlci5oaWRlKCgoX2N1cnJlbnRGcmFtZSA9PT0gMCkgPyAxIDogMCkpO1xuICAgICAgX2ZyYW1lQ29udHJvbGxlci5jcmVhdGVGcmFtZVBsYXllcigoKF9jdXJyZW50RnJhbWUgPT09IDApID8gMSA6IDApLCBfYWRkaXRpb25hbFBhcmFtcywgX2N1cnJlbnRGaWxlcyk7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBzZXRBZGRpdGlvbmFsUGFyYW1zKG5hbWVzLCB2YWx1ZXMpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lcykgJiYgbmFtZXMubGVuZ3RoID4gMCAmJiBuYW1lc1swXSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMgPSBKU09OLnBhcnNlKHZhbHVlc1swXSk7XG4gICAgICAgIF9wcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCk7XG5cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0NvbnRhaW5lclwiKS5zdHlsZS5oZWlnaHQgPSBfcHJlZnMuZ2V0SW50KFwicnNIXCIpICsgXCJweFwiO1xuXG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLndpZHRoID0gX3ByZWZzLmdldEludChcInJzV1wiKTtcbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKTtcblxuICAgICAgICAvLyBjcmVhdGUgYW5kIGluaXRpYWxpemUgdGhlIEJhY2tncm91bmQgaW5zdGFuY2VcbiAgICAgICAgX2JhY2tncm91bmQgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uQmFja2dyb3VuZChfYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICAgIF9iYWNrZ3JvdW5kLmluaXQoX2JhY2tncm91bmRSZWFkeSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRW5kZWQoKSB7XG4gICAgX2ZyYW1lQ29udHJvbGxlci5zaG93KChfY3VycmVudEZyYW1lID09PSAwKSA/IDEgOiAwKTtcbiAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfZG9uZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyUmVhZHkoKSB7XG4gICAgaWYgKCFfaW5pdGlhbGl6ZWQpIHtcbiAgICAgIGlmIChfZnJhbWVDb3VudCA9PT0gMikge1xuICAgICAgICAvLyBib3RoIGZyYW1lcyBoYXZlIGJlZW4gY3JlYXRlZCBhbmQgbG9hZGVkLCBjYW4gbm90aWZ5IFZpZXdlciB3aWRnZXQgaXMgcmVhZHlcbiAgICAgICAgX2luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgX3JlYWR5KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBmaXJzdCBmcmFtZSBwbGF5ZXIgd2FzIHN1Y2Nlc3NmdWwgYW5kIHJlYWR5LCBjcmVhdGUgdGhlIHNlY29uZCBvbmUgYnV0IGhpZGUgaXRcbiAgICAgICAgX2ZyYW1lQ29udHJvbGxlci5hZGQoMSk7XG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIuaGlkZSgxKTtcbiAgICAgICAgX2ZyYW1lQ291bnQgPSAyO1xuICAgICAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDEsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGVzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIGNvbnNvbGUuZGVidWcoXCJ2aWRlby1mb2xkZXI6OnBsYXllckVycm9yKClcIiwgZXJyb3IpO1xuXG4gICAgaWYgKCFfaW5pdGlhbGl6ZWQpIHtcbiAgICAgIC8vIFdpZGdldCBoYXMgbm90IHNlbnQgXCJyZWFkeVwiIHlldCBhbmQgdGhlcmUgaXMgYW4gZXJyb3IgKHNldHVwIG9yIHBsYXliYWNrIG9mIGZpcnN0IHZpZGVvLCBkb2Vzbid0IG1hdHRlciB3aGljaClcbiAgICAgIF9mcmFtZUNvbnRyb2xsZXIucmVtb3ZlKF9jdXJyZW50RnJhbWUpO1xuXG4gICAgICAvLyBkbyBub3RoaW5nIG1vcmUsIGVuc3VyZSBcInJlYWR5XCIgaXMgbm90IHNlbnQgdG8gVmlld2VyIHNvIHRoYXQgdGhpcyB3aWRnZXQgY2FuIGJlIHNraXBwZWRcblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBmb3JjZSB3aWRnZXQgdG8gYWN0IGFzIHRob3VnaCB0aGUgcGxheWxpc3QgaXMgZG9uZVxuICAgICAgcGxheWVyRW5kZWQoKTtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJvblN0b3JhZ2VJbml0XCI6IG9uU3RvcmFnZUluaXQsXG4gICAgXCJvblN0b3JhZ2VSZWZyZXNoXCI6IG9uU3RvcmFnZVJlZnJlc2gsXG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInNldEFkZGl0aW9uYWxQYXJhbXNcIjogc2V0QWRkaXRpb25hbFBhcmFtcyxcbiAgICBcInBsYXllckVuZGVkXCI6IHBsYXllckVuZGVkLFxuICAgIFwicGxheWVyUmVhZHlcIjogcGxheWVyUmVhZHksXG4gICAgXCJwbGF5ZXJFcnJvclwiOiBwbGF5ZXJFcnJvcixcbiAgICBcInN0b3BcIjogc3RvcFxuICB9O1xuXG59KShnYWRnZXRzKTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uQmFja2dyb3VuZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfY2FsbGJhY2sgPSBudWxsLFxuICAgIF9yZWFkeSA9IGZhbHNlLFxuICAgIF9iYWNrZ3JvdW5kID0gbnVsbCxcbiAgICBfc3RvcmFnZSA9IG51bGwsXG4gICAgX3JlZnJlc2hEdXJhdGlvbiA9IDkwMDAwMCwgLy8gMTUgbWludXRlc1xuICAgIF9pc1N0b3JhZ2VGaWxlID0gZmFsc2UsXG4gICAgX3NlcGFyYXRvciA9IFwiXCI7XG5cbiAgLypcbiAgICogUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfcmVmcmVzaFRpbWVyKCkge1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gYmFja2dyb3VuZFJlZnJlc2goKSB7XG4gICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwgKyBfc2VwYXJhdG9yICsgXCJjYj1cIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgXCIpXCI7XG4gICAgICBfcmVmcmVzaFRpbWVyKCk7XG4gICAgfSwgX3JlZnJlc2hEdXJhdGlvbik7XG4gIH1cblxuICBmdW5jdGlvbiBfYmFja2dyb3VuZFJlYWR5KCkge1xuICAgIF9yZWFkeSA9IHRydWU7XG5cbiAgICBpZiAoZGF0YS5iYWNrZ3JvdW5kLnVzZUltYWdlICYmICFfaXNTdG9yYWdlRmlsZSkge1xuICAgICAgLy8gc3RhcnQgdGhlIHJlZnJlc2ggcG9sbCBmb3Igbm9uLXN0b3JhZ2UgYmFja2dyb3VuZCBpbWFnZVxuICAgICAgX3JlZnJlc2hUaW1lcigpO1xuICAgIH1cblxuICAgIGlmIChfY2FsbGJhY2sgJiYgdHlwZW9mIF9jYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBfY2FsbGJhY2soKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfY29uZmlndXJlKCkge1xuICAgIHZhciBzdHI7XG5cbiAgICBfYmFja2dyb3VuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZFwiKTtcbiAgICBfc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFja2dyb3VuZFN0b3JhZ2VcIik7XG5cbiAgICAvLyBzZXQgdGhlIGRvY3VtZW50IGJhY2tncm91bmRcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmQgPSBkYXRhLmJhY2tncm91bmQuY29sb3I7XG5cbiAgICBpZiAoX2JhY2tncm91bmQpIHtcbiAgICAgIGlmIChkYXRhLmJhY2tncm91bmQudXNlSW1hZ2UpIHtcbiAgICAgICAgX2JhY2tncm91bmQuY2xhc3NOYW1lID0gZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnBvc2l0aW9uO1xuICAgICAgICBfYmFja2dyb3VuZC5jbGFzc05hbWUgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2Uuc2NhbGUgPyBfYmFja2dyb3VuZC5jbGFzc05hbWUgKyBcIiBzY2FsZS10by1maXRcIlxuICAgICAgICAgIDogX2JhY2tncm91bmQuY2xhc3NOYW1lO1xuXG4gICAgICAgIF9pc1N0b3JhZ2VGaWxlID0gKE9iamVjdC5rZXlzKGRhdGEuYmFja2dyb3VuZFN0b3JhZ2UpLmxlbmd0aCAhPT0gMCk7XG5cbiAgICAgICAgaWYgKCFfaXNTdG9yYWdlRmlsZSkge1xuICAgICAgICAgIHN0ciA9IGRhdGEuYmFja2dyb3VuZC5pbWFnZS51cmwuc3BsaXQoXCI/XCIpO1xuXG4gICAgICAgICAgLy8gc3RvcmUgdGhpcyBmb3IgdGhlIHJlZnJlc2ggdGltZXJcbiAgICAgICAgICBfc2VwYXJhdG9yID0gKHN0ci5sZW5ndGggPT09IDEpID8gXCI/XCIgOiBcIiZcIjtcblxuICAgICAgICAgIF9iYWNrZ3JvdW5kLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnVybCArIFwiKVwiO1xuICAgICAgICAgIF9iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoX3N0b3JhZ2UpIHtcbiAgICAgICAgICAgIC8vIFJpc2UgU3RvcmFnZVxuICAgICAgICAgICAgX3N0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICBpZiAoZS5kZXRhaWwgJiYgZS5kZXRhaWwuZmlsZXMgJiYgZS5kZXRhaWwuZmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIF9iYWNrZ3JvdW5kLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgZS5kZXRhaWwuZmlsZXNbMF0udXJsICsgXCIpXCI7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoIV9yZWFkeSkge1xuICAgICAgICAgICAgICAgIF9iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmZvbGRlcik7XG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmZpbGVOYW1lKTtcbiAgICAgICAgICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImNvbXBhbnlJZFwiLCBkYXRhLmJhY2tncm91bmRTdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgICAgICAgICBfc3RvcmFnZS5nbygpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1pc3NpbmcgZWxlbWVudCB3aXRoIGlkIHZhbHVlIG9mICdiYWNrZ3JvdW5kU3RvcmFnZSdcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfYmFja2dyb3VuZFJlYWR5KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiTWlzc2luZyBlbGVtZW50IHdpdGggaWQgdmFsdWUgb2YgJ2JhY2tncm91bmQnXCIpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdChjYikge1xuICAgIGlmICghX3JlYWR5KSB7XG4gICAgICBpZiAoY2IpIHtcbiAgICAgICAgX2NhbGxiYWNrID0gY2I7XG4gICAgICB9XG5cbiAgICAgIF9jb25maWd1cmUoKTtcblxuICAgIH0gZWxzZSBpZiAoY2IgJiYgdHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGNiKCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlb0ZvbGRlciA9IFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgfHwge307XG5cblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuU3RvcmFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfaW5pdGlhbExvYWQgPSB0cnVlO1xuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Gb2xkZXJTdG9yYWdlXCIpLFxuICAgICAgc29ydCA9IFwiXCIsXG4gICAgICBzb3J0RGlyZWN0aW9uID0gXCJcIjtcblxuICAgIGlmICghc3RvcmFnZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgdXJscyA9IFtdO1xuXG4gICAgICBpZiAoZS5kZXRhaWwgJiYgZS5kZXRhaWwuZmlsZXMgJiYgZS5kZXRhaWwuZmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBlLmRldGFpbC5maWxlcy5mb3JFYWNoKGZ1bmN0aW9uKGZpbGUpIHtcbiAgICAgICAgICB1cmxzLnB1c2goZmlsZS51cmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoX2luaXRpYWxMb2FkKSB7XG4gICAgICAgICAgX2luaXRpYWxMb2FkID0gZmFsc2U7XG5cbiAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLm9uU3RvcmFnZUluaXQodXJscyk7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLm9uU3RvcmFnZVJlZnJlc2godXJscyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5zdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS5zdG9yYWdlLmZvbGRlcik7XG5cbiAgICAvLyBTb3J0aW5nXG4gICAgc3dpdGNoIChkYXRhLm9yZGVyKSB7XG4gICAgICBjYXNlIFwiYWxwaGEtYXNjXCI6XG4gICAgICAgIHNvcnQgPSBcIm5hbWVcIjtcbiAgICAgICAgc29ydERpcmVjdGlvbiA9IFwiYXNjXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImFscGhhLWRlc2NcIjpcbiAgICAgICAgc29ydCA9IFwibmFtZVwiO1xuICAgICAgICBzb3J0RGlyZWN0aW9uID0gXCJkZXNjXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImRhdGUtYXNjXCI6XG4gICAgICAgIHNvcnQgPSBcImRhdGVcIjtcbiAgICAgICAgc29ydERpcmVjdGlvbiA9IFwiYXNjXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImRhdGUtZGVzY1wiOlxuICAgICAgICBzb3J0ID0gXCJkYXRlXCI7XG4gICAgICAgIHNvcnREaXJlY3Rpb24gPSBcImRlc2NcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicmFuZG9tXCI6XG4gICAgICAgIHNvcnQgPSBcInJhbmRvbVwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHNvcnQgPSBcIm5hbWVcIjtcbiAgICAgICAgc29ydERpcmVjdGlvbiA9IFwiYXNjXCI7XG4gICAgfVxuXG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJzb3J0XCIsIHNvcnQpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwic29ydERpcmVjdGlvblwiLCBzb3J0RGlyZWN0aW9uKTtcbiAgICBzdG9yYWdlLmdvKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiaW5pdFwiOiBpbml0XG4gIH07XG59O1xuXG4vKiBnbG9iYWwgY29uZmlnICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgPSBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyIHx8IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvRm9sZGVyLkZyYW1lQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIFBSRUZJWCA9IFwiaWZfXCI7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2NsZWFyKGluZGV4KSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJFRklYICsgaW5kZXgpLFxuICAgICAgaWZyYW1lLCBmcmFtZU9iajtcblxuICAgIHRyeSB7XG4gICAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xuICAgICAgZnJhbWVPYmogPSAoaWZyYW1lLmNvbnRlbnRXaW5kb3cpID8gaWZyYW1lLmNvbnRlbnRXaW5kb3cgOlxuICAgICAgICAoaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCkgPyBpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50IDogaWZyYW1lLmNvbnRlbnREb2N1bWVudDtcbiAgICAgIGZyYW1lT2JqLnJlbW92ZSgpO1xuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBcImFib3V0OmJsYW5rXCIpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5kZWJ1ZyhlKTtcbiAgICB9XG5cbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cblxuICBmdW5jdGlvbiBhZGQoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIsIGlmcmFtZTtcblxuICAgIGZyYW1lQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJFRklYICsgaW5kZXgpO1xuXG4gICAgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwiYWxsb3dUcmFuc3BhcmVuY3lcIiwgdHJ1ZSk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcImZyYW1lYm9yZGVyXCIsIFwiMFwiKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic2Nyb2xsaW5nXCIsIFwibm9cIik7XG5cbiAgICBmcmFtZUNvbnRhaW5lci5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlRnJhbWVQbGF5ZXIoaW5kZXgsIHBhcmFtcywgZmlsZXMpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCksXG4gICAgICBpZnJhbWU7XG5cbiAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xuXG4gICAgaWYgKGlmcmFtZSkge1xuICAgICAgaWZyYW1lLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9IG51bGw7XG5cbiAgICAgICAgdmFyIGZyYW1lT2JqID0gKGlmcmFtZS5jb250ZW50V2luZG93KSA/IGlmcmFtZS5jb250ZW50V2luZG93IDpcbiAgICAgICAgICAoaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCkgPyBpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50IDogaWZyYW1lLmNvbnRlbnREb2N1bWVudDtcblxuICAgICAgICAvLyBpbml0aWFsaXplIGFuZCBsb2FkIHRoZSBwbGF5ZXIgaW5zaWRlIHRoZSBpZnJhbWVcbiAgICAgICAgZnJhbWVPYmouaW5pdChwYXJhbXMsIGZpbGVzLCBjb25maWcuU0tJTik7XG4gICAgICB9O1xuXG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic3JjXCIsIFwicGxheWVyLmh0bWxcIik7XG4gICAgfVxuXG4gIH1cblxuICBmdW5jdGlvbiBnZXRGcmFtZU9iamVjdChpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KSxcbiAgICAgIGlmcmFtZTtcblxuICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XG5cbiAgICBpZiAoaWZyYW1lKSB7XG4gICAgICByZXR1cm4gKGlmcmFtZS5jb250ZW50V2luZG93KSA/IGlmcmFtZS5jb250ZW50V2luZG93IDpcbiAgICAgICAgKGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQpID8gaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCA6IGlmcmFtZS5jb250ZW50RG9jdW1lbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBoaWRlKGluZGV4KSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJFRklYICsgaW5kZXgpLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlKGluZGV4LCBjYWxsYmFjaykge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcblxuICAgIF9jbGVhcihpbmRleCk7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIHJlbW92ZSB0aGUgaWZyYW1lIGJ5IGNsZWFyaW5nIGFsbCBlbGVtZW50cyBpbnNpZGUgZGl2IGNvbnRhaW5lclxuICAgICAgd2hpbGUgKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgZnJhbWVDb250YWluZXIucmVtb3ZlQ2hpbGQoZnJhbWVDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjYWxsYmFjayAmJiB0eXBlb2YgY2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH0sIDIwMCk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93KGluZGV4KSB7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUFJFRklYICsgaW5kZXgpLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYWRkOiBhZGQsXG4gICAgY3JlYXRlRnJhbWVQbGF5ZXI6IGNyZWF0ZUZyYW1lUGxheWVyLFxuICAgIGdldEZyYW1lT2JqZWN0OiBnZXRGcmFtZU9iamVjdCxcbiAgICBoaWRlOiBoaWRlLFxuICAgIHJlbW92ZTogcmVtb3ZlLFxuICAgIHNob3c6IHNob3dcbiAgfTtcbn07XG5cbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9seW1lclJlYWR5KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9seW1lci1yZWFkeVwiLCBwb2x5bWVyUmVhZHkpO1xuXG4gICAgaWYgKGlkICYmIGlkICE9PSBcIlwiKSB7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BsYXlfXCIgKyBpZCwgcGxheSk7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BhdXNlX1wiICsgaWQsIHBhdXNlKTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfc3RvcF9cIiArIGlkLCBzdG9wKTtcblxuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLnNldEFkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBbXCJhZGRpdGlvbmFsUGFyYW1zXCJdKTtcbiAgICB9XG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvbHltZXItcmVhZHlcIiwgcG9seW1lclJlYWR5KTtcblxufSkod2luZG93LCBnYWRnZXRzKTtcblxuXG5cbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktNCddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=