if("undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.VideoFolder={},RiseVision.VideoFolder=function(e){"use strict";function t(){e.rpc.call("","rsevent_done",null,y.getString("id"))}function n(){console.log("video-folder.js::_ready()",f.storage.folder),e.rpc.call("","rsevent_ready",null,y.getString("id"),!0,!0,!0,!0,!0)}function i(){V=new RiseVision.Common.Video.FrameController,V.add(0),p=0,V.createFramePlayer(0,f,g,config.SKIN,"player.html")}function o(e){g=e,i()}function r(e){g=e,h=!1}function s(){var e=V.getFrameObject(p);e&&e.pause()}function a(){var e=V.getFrameObject(p);h?t():e?e.play():(V.add(0),V.createFramePlayer(0,f,g,config.SKIN,"player.html"))}function l(t,n){Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(n)&&n.length>0&&(f=JSON.parse(n[0]),y=new e.Prefs,document.getElementById("videoContainer").style.height=y.getInt("rsH")+"px",f.width=y.getInt("rsW"),f.height=y.getInt("rsH"),v=new RiseVision.VideoFolder.Storage(f),v.init())}function d(){V.remove(p,function(){t()})}function c(){var e;R?(e=V.getFrameObject(p),e.play()):(R=!0,n())}function u(e){console.debug("video-folder::playerError()",e),R?(("setup"===e.type||0===e.index)&&(h=!0),d()):V.remove(p)}function m(){s()}var f,g,p,y=null,v=null,V=null,R=!1,h=!1;return{onStorageInit:o,onStorageRefresh:r,pause:s,play:a,setAdditionalParams:l,playerEnded:d,playerReady:c,playerError:u,stop:m}}(gadgets);var RiseVision=RiseVision||{};RiseVision.VideoFolder=RiseVision.VideoFolder||{},RiseVision.VideoFolder.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoFolderStorage");t&&(t.addEventListener("rise-storage-response",function(e){var t=[];e.detail&&e.detail.files&&e.detail.files.length>0&&(e.detail.files.forEach(function(e){t.push(e.url)}),n?(n=!1,RiseVision.VideoFolder.onStorageInit(t)):RiseVision.VideoFolder.onStorageRefresh(t))}),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("folder",e.storage.folder),t.go())}var n=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(l+e)}function t(t){var n,i=e(t);return n=i.querySelector("iframe"),n?n.contentWindow?n.contentWindow:n.contentDocument.document?n.contentDocument.document:n.contentDocument:null}function n(n){var i,o=e(n),r=t(n);r&&(i=o.querySelector("iframe"),r.remove(),i.setAttribute("src","about:blank"))}function i(t){var n=e(t),i=document.createElement("iframe");i.setAttribute("allowTransparency",!0),i.setAttribute("frameborder","0"),i.setAttribute("scrolling","no"),n.appendChild(i)}function o(n,i,o,r,s){var a,l=e(n),d=t(n);d&&(a=l.querySelector("iframe"),a.onload=function(){a.onload=null,d.init(i,o,r),d.load()},a.setAttribute("src",s))}function r(t){var n=e(t);n.style.visibility="hidden"}function s(e,t){var i=document.getElementById(l+e);n(e),setTimeout(function(){for(;i.firstChild;)i.removeChild(i.firstChild);t&&"function"==typeof t&&t()},200)}function a(t){var n=e(t);n.style.visibility="visible"}var l="if_";return{add:i,createFramePlayer:o,getFrameContainer:e,getFrameObject:t,hide:r,remove:s,show:a}},function(e,t){"use strict";function n(){RiseVision.VideoFolder.play()}function i(){RiseVision.VideoFolder.pause()}function o(){RiseVision.VideoFolder.stop()}function r(){e.removeEventListener("polymer-ready",r),a&&""!==a&&(t.rpc.register("rscmd_play_"+a,n),t.rpc.register("rscmd_pause_"+a,i),t.rpc.register("rscmd_stop_"+a,o),t.rpc.register("rsparam_set_"+a,RiseVision.VideoFolder.setAdditionalParams),t.rpc.call("","rsparam_get",null,a,["additionalParams"]))}var s=new t.Prefs,a=s.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("polymer-ready",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-4"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiU0tJTiIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25zdGFudCIsIlJpc2VWaXNpb24iLCJWaWRlb0ZvbGRlciIsImdhZGdldHMiLCJfZG9uZSIsInJwYyIsImNhbGwiLCJfcHJlZnMiLCJnZXRTdHJpbmciLCJfcmVhZHkiLCJjb25zb2xlIiwibG9nIiwiX2FkZGl0aW9uYWxQYXJhbXMiLCJzdG9yYWdlIiwiZm9sZGVyIiwiX2luaXQiLCJfZnJhbWVDb250cm9sbGVyIiwiQ29tbW9uIiwiVmlkZW8iLCJGcmFtZUNvbnRyb2xsZXIiLCJhZGQiLCJfY3VycmVudEZyYW1lIiwiY3JlYXRlRnJhbWVQbGF5ZXIiLCJfY3VycmVudEZpbGVzIiwib25TdG9yYWdlSW5pdCIsInVybHMiLCJvblN0b3JhZ2VSZWZyZXNoIiwiX3BsYXliYWNrRXJyb3IiLCJwYXVzZSIsImZyYW1lT2JqIiwiZ2V0RnJhbWVPYmplY3QiLCJwbGF5Iiwic2V0QWRkaXRpb25hbFBhcmFtcyIsIm5hbWVzIiwidmFsdWVzIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwiSlNPTiIsInBhcnNlIiwiUHJlZnMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJoZWlnaHQiLCJnZXRJbnQiLCJ3aWR0aCIsIl9zdG9yYWdlIiwiU3RvcmFnZSIsImluaXQiLCJwbGF5ZXJFbmRlZCIsInJlbW92ZSIsInBsYXllclJlYWR5IiwiX2luaXRpYWxpemVkIiwicGxheWVyRXJyb3IiLCJlcnJvciIsImRlYnVnIiwidHlwZSIsImluZGV4Iiwic3RvcCIsImRhdGEiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImRldGFpbCIsImZpbGVzIiwiZm9yRWFjaCIsImZpbGUiLCJwdXNoIiwidXJsIiwiX2luaXRpYWxMb2FkIiwic2V0QXR0cmlidXRlIiwiY29tcGFueUlkIiwiZ28iLCJnZXRGcmFtZUNvbnRhaW5lciIsIlBSRUZJWCIsImlmcmFtZSIsImZyYW1lQ29udGFpbmVyIiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnRXaW5kb3ciLCJjb250ZW50RG9jdW1lbnQiLCJfY2xlYXIiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJwYXJhbXMiLCJza2luIiwic3JjIiwib25sb2FkIiwibG9hZCIsImhpZGUiLCJ2aXNpYmlsaXR5IiwiY2FsbGJhY2siLCJzZXRUaW1lb3V0IiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwic2hvdyIsIndpbmRvdyIsInBvbHltZXJSZWFkeSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJpZCIsInJlZ2lzdGVyIiwicHJlZnMiLCJvbmNvbnRleHRtZW51IiwiX2dhcSIsImdhIiwiYXN5bmMiLCJsb2NhdGlvbiIsInByb3RvY29sIiwicyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSJdLCJtYXBwaW5ncyI6IkFBRUEsR0FBc0IsbUJBQVhBLFFBQXdCLENBQ2pDLEdBQUlBLFNBQ0ZDLEtBQU0sa0JBR2Usb0JBQVpDLFVBQ1RBLFFBQVFDLE9BQU8sb0NBQ1pDLFNBQVMsaUJBQWtCLHdCQUMzQkEsU0FBUyxnQkFBaUIsU0FNakMsR0FBSUMsWUFBYUEsY0FDakJBLFlBQVdDLGVBRVhELFdBQVdDLFlBQWMsU0FBV0MsR0FDbEMsWUFnQkEsU0FBU0MsS0FDUEQsRUFBUUUsSUFBSUMsS0FBSyxHQUFJLGVBQWdCLEtBQU1DLEVBQU9DLFVBQVUsT0FHOUQsUUFBU0MsS0FDUEMsUUFBUUMsSUFBSSw0QkFBNkJDLEVBQWtCQyxRQUFRQyxRQUVuRVgsRUFBUUUsSUFBSUMsS0FBSyxHQUFJLGdCQUFpQixLQUFNQyxFQUFPQyxVQUFVLE9BQzNELEdBQU0sR0FBTSxHQUFNLEdBQU0sR0FHNUIsUUFBU08sS0FDUEMsRUFBbUIsR0FBSWYsWUFBV2dCLE9BQU9DLE1BQU1DLGdCQUcvQ0gsRUFBaUJJLElBQUksR0FDckJDLEVBQWdCLEVBQ2hCTCxFQUFpQk0sa0JBQWtCLEVB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QzFCbUMsS0FBS25DLE1BQU0sbUJBRVgsV0FDRSxHQUFJb0MsR0FBSzlELFNBQVN3QyxjQUFjLFNBQVdzQixHQUFHOUMsS0FBTyxrQkFBbUI4QyxFQUFHQyxPQUFRLEVBQ25GRCxFQUFHbEIsS0FBTyxVQUFZNUMsU0FBU2dFLFNBQVNDLFNBQVcsY0FBZ0IsY0FBZ0IsNkJBQ25GLElBQUlDLEdBQUlsRSxTQUFTbUUscUJBQXFCLFVBQVUsRUFBSUQsR0FBRUUsV0FBV0MsYUFBYVAsRUFBSUkiLCJmaWxlIjoianMvd2lkZ2V0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBjb25maWc6IHRydWUgKi9cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xuaWYgKHR5cGVvZiBjb25maWcgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBTS0lOOiBcInNraW4vUlZTa2luLnhtbFwiXG4gIH07XG5cbiAgaWYgKHR5cGVvZiBhbmd1bGFyICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgYW5ndWxhci5tb2R1bGUoXCJyaXNldmlzaW9uLmNvbW1vbi5pMThuLmNvbmZpZ1wiLCBbXSlcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfUFJFRklYXCIsIFwibG9jYWxlcy90cmFuc2xhdGlvbl9cIilcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiKTtcbiAgfVxufVxuXG4vKiBnbG9iYWwgZ2FkZ2V0cywgY29uZmlnICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgPSB7fTtcblxuUmlzZVZpc2lvbi5WaWRlb0ZvbGRlciA9IChmdW5jdGlvbiAoZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2FkZGl0aW9uYWxQYXJhbXM7XG5cbiAgdmFyIF9wcmVmcyA9IG51bGwsXG4gICAgX3N0b3JhZ2UgPSBudWxsLFxuICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBudWxsO1xuXG4gIHZhciBfaW5pdGlhbGl6ZWQgPSBmYWxzZSxcbiAgICBfcGxheWJhY2tFcnJvciA9IGZhbHNlO1xuXG4gIHZhciBfY3VycmVudEZpbGVzLCBfY3VycmVudEZyYW1lO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9kb25lKCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X2RvbmVcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBjb25zb2xlLmxvZyhcInZpZGVvLWZvbGRlci5qczo6X3JlYWR5KClcIiwgX2FkZGl0aW9uYWxQYXJhbXMuc3RvcmFnZS5mb2xkZXIpO1xuXG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfcmVhZHlcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpLFxuICAgICAgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBfaW5pdCgpIHtcbiAgICBfZnJhbWVDb250cm9sbGVyID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLlZpZGVvLkZyYW1lQ29udHJvbGxlcigpO1xuXG4gICAgLy8gYWRkIHRoZSBmaXJzdCBmcmFtZSBhbmQgY3JlYXRlIGl0cyBwbGF5ZXJcbiAgICBfZnJhbWVDb250cm9sbGVyLmFkZCgwKTtcbiAgICBfY3VycmVudEZyYW1lID0gMDtcbiAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDAsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGVzLCBjb25maWcuU0tJTiwgXCJwbGF5ZXIuaHRtbFwiKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gb25TdG9yYWdlSW5pdCh1cmxzKSB7XG4gICAgX2N1cnJlbnRGaWxlcyA9IHVybHM7XG5cbiAgICBfaW5pdCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25TdG9yYWdlUmVmcmVzaCh1cmxzKSB7XG4gICAgX2N1cnJlbnRGaWxlcyA9IHVybHM7XG5cbiAgICAvLyBpbiBjYXNlIHJlZnJlc2hlZCBmaWxlcyBmaXggYW4gZXJyb3Igd2l0aCBwcmV2aW91cyBzZXR1cCBvciBpbml0aWFsIGZpbGUgcHJvYmxlbSxcbiAgICAvLyBlbnN1cmUgZmxhZyBpcyByZW1vdmVkIHNvIHBsYXliYWNrIGlzIGF0dGVtcHRlZCBhZ2FpblxuICAgIF9wbGF5YmFja0Vycm9yID0gZmFsc2U7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICB2YXIgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICBmcmFtZU9iai5wYXVzZSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgdmFyIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcblxuICAgIGlmICghX3BsYXliYWNrRXJyb3IpIHtcbiAgICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgICBmcmFtZU9iai5wbGF5KCk7XG4gICAgICB9IGVsc2Uge1xuXG4gICAgICAgIC8vIHJlLWFkZCBwcmV2aW91c2x5IHJlbW92ZWQgZnJhbWUgYW5kIGNyZWF0ZSB0aGUgcGxheWVyLCBidXQgaGlkZSB2aXNpYmlsaXR5XG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIuYWRkKDApO1xuICAgICAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDAsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGVzLCBjb25maWcuU0tJTiwgXCJwbGF5ZXIuaHRtbFwiKTtcblxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGlzIGZsYWcgb25seSBnb3Qgc2V0IHVwb24gYSByZWZyZXNoIG9mIGhpZGRlbiBmcmFtZSBhbmQgdGhlcmUgd2FzIGFuIGVycm9yIGluIHNldHVwIG9yIGZpcnN0IHZpZGVvXG4gICAgICAvLyBTZW5kIFZpZXdlciBcImRvbmVcIlxuICAgICAgX2RvbmUoKTtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMobmFtZXMsIHZhbHVlcykge1xuICAgIGlmIChBcnJheS5pc0FycmF5KG5hbWVzKSAmJiBuYW1lcy5sZW5ndGggPiAwICYmIG5hbWVzWzBdID09PSBcImFkZGl0aW9uYWxQYXJhbXNcIikge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzKSAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcyA9IEpTT04ucGFyc2UodmFsdWVzWzBdKTtcbiAgICAgICAgX3ByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKTtcblxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLnN0eWxlLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIikgKyBcInB4XCI7XG5cbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMud2lkdGggPSBfcHJlZnMuZ2V0SW50KFwicnNXXCIpO1xuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy5oZWlnaHQgPSBfcHJlZnMuZ2V0SW50KFwicnNIXCIpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBhbmQgaW5pdGlhbGl6ZSB0aGUgU3RvcmFnZSBtb2R1bGUgaW5zdGFuY2VcbiAgICAgICAgX3N0b3JhZ2UgPSBuZXcgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5TdG9yYWdlKF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgX3N0b3JhZ2UuaW5pdCgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllckVuZGVkKCkge1xuICAgIF9mcmFtZUNvbnRyb2xsZXIucmVtb3ZlKF9jdXJyZW50RnJhbWUsIGZ1bmN0aW9uICgpIHtcbiAgICAgIF9kb25lKCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJSZWFkeSgpIHtcbiAgICB2YXIgZnJhbWVPYmo7XG5cbiAgICBpZiAoIV9pbml0aWFsaXplZCkge1xuICAgICAgX2luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgIF9yZWFkeSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG4gICAgICBmcmFtZU9iai5wbGF5KCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICBjb25zb2xlLmRlYnVnKFwidmlkZW8tZm9sZGVyOjpwbGF5ZXJFcnJvcigpXCIsIGVycm9yKTtcblxuICAgIGlmICghX2luaXRpYWxpemVkKSB7XG4gICAgICAvLyBXaWRnZXQgaGFzIG5vdCBzZW50IFwicmVhZHlcIiB5ZXQgYW5kIHRoZXJlIGlzIGFuIGVycm9yIChzZXR1cCBvciBwbGF5YmFjayBvZiBmaXJzdCB2aWRlbywgZG9lc24ndCBtYXR0ZXIgd2hpY2gpXG4gICAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lKTtcblxuICAgICAgLy8gZG8gbm90aGluZyBtb3JlLCBlbnN1cmUgXCJyZWFkeVwiIGlzIG5vdCBzZW50IHRvIFZpZXdlciBzbyB0aGF0IHRoaXMgd2lkZ2V0IGNhbiBiZSBza2lwcGVkXG5cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGVycm9yLnR5cGUgPT09IFwic2V0dXBcIiB8fCBlcnJvci5pbmRleCA9PT0gMCkge1xuICAgICAgICAvLyBUaGlzIG9ubHkgaGFwcGVucyBpbiB0aGUgZXZlbnQgb2YgYSByZWZyZXNoLiBOZXcgZmlsZXMgY2F1c2VkIGFuIGVycm9yIGluIHNldHVwIG9yIGZpcnN0IHZpZGVvIGhhcyBhbiBpc3N1ZVxuICAgICAgICBfcGxheWJhY2tFcnJvciA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIGZvcmNlIHdpZGdldCB0byBhY3QgYXMgdGhvdWdoIHRoZSBwbGF5bGlzdCBpcyBkb25lXG4gICAgICBwbGF5ZXJFbmRlZCgpO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBwYXVzZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcIm9uU3RvcmFnZUluaXRcIjogb25TdG9yYWdlSW5pdCxcbiAgICBcIm9uU3RvcmFnZVJlZnJlc2hcIjogb25TdG9yYWdlUmVmcmVzaCxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwicGxheWVyRW5kZWRcIjogcGxheWVyRW5kZWQsXG4gICAgXCJwbGF5ZXJSZWFkeVwiOiBwbGF5ZXJSZWFkeSxcbiAgICBcInBsYXllckVycm9yXCI6IHBsYXllckVycm9yLFxuICAgIFwic3RvcFwiOiBzdG9wXG4gIH07XG5cbn0pKGdhZGdldHMpO1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvRm9sZGVyID0gUmlzZVZpc2lvbi5WaWRlb0ZvbGRlciB8fCB7fTtcblxuUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5TdG9yYWdlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9pbml0aWFsTG9hZCA9IHRydWU7XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBpbml0KCkge1xuICAgIHZhciBzdG9yYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0ZvbGRlclN0b3JhZ2VcIik7XG5cbiAgICBpZiAoIXN0b3JhZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgdmFyIHVybHMgPSBbXTtcblxuICAgICAgaWYgKGUuZGV0YWlsICYmIGUuZGV0YWlsLmZpbGVzICYmIGUuZGV0YWlsLmZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZS5kZXRhaWwuZmlsZXMuZm9yRWFjaChmdW5jdGlvbihmaWxlKSB7XG4gICAgICAgICAgdXJscy5wdXNoKGZpbGUudXJsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKF9pbml0aWFsTG9hZCkge1xuICAgICAgICAgIF9pbml0aWFsTG9hZCA9IGZhbHNlO1xuXG4gICAgICAgICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5vblN0b3JhZ2VJbml0KHVybHMpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5vblN0b3JhZ2VSZWZyZXNoKHVybHMpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9KTtcblxuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEuc3RvcmFnZS5jb21wYW55SWQpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZm9sZGVyXCIsIGRhdGEuc3RvcmFnZS5mb2xkZXIpO1xuXG4gICAgc3RvcmFnZS5nbygpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uVmlkZW8gPSBSaXNlVmlzaW9uLkNvbW1vbi5WaWRlbyB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uVmlkZW8uRnJhbWVDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgUFJFRklYID0gXCJpZl9cIjtcblxuICBmdW5jdGlvbiBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCkge1xuICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRGcmFtZU9iamVjdChpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcbiAgICAgIGlmcmFtZTtcblxuICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XG5cbiAgICBpZiAoaWZyYW1lKSB7XG4gICAgICByZXR1cm4gKGlmcmFtZS5jb250ZW50V2luZG93KSA/IGlmcmFtZS5jb250ZW50V2luZG93IDpcbiAgICAgICAgKGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQpID8gaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCA6IGlmcmFtZS5jb250ZW50RG9jdW1lbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBfY2xlYXIoaW5kZXgpIHtcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXG4gICAgICBmcmFtZU9iaiA9IGdldEZyYW1lT2JqZWN0KGluZGV4KSxcbiAgICAgIGlmcmFtZTtcblxuICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcbiAgICAgIGZyYW1lT2JqLnJlbW92ZSgpO1xuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBcImFib3V0OmJsYW5rXCIpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZChpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcbiAgICAgIGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpZnJhbWVcIik7XG5cbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwiYWxsb3dUcmFuc3BhcmVuY3lcIiwgdHJ1ZSk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcImZyYW1lYm9yZGVyXCIsIFwiMFwiKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic2Nyb2xsaW5nXCIsIFwibm9cIik7XG5cbiAgICBmcmFtZUNvbnRhaW5lci5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlRnJhbWVQbGF5ZXIoaW5kZXgsIHBhcmFtcywgZmlsZXMsIHNraW4sIHNyYykge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcbiAgICAgIGZyYW1lT2JqID0gZ2V0RnJhbWVPYmplY3QoaW5kZXgpLFxuICAgICAgaWZyYW1lO1xuXG4gICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xuXG4gICAgICBpZnJhbWUub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZnJhbWUub25sb2FkID0gbnVsbDtcblxuICAgICAgICAvLyBpbml0aWFsaXplIGFuZCBsb2FkIHRoZSBwbGF5ZXIgaW5zaWRlIHRoZSBpZnJhbWVcbiAgICAgICAgZnJhbWVPYmouaW5pdChwYXJhbXMsIGZpbGVzLCBza2luKTtcbiAgICAgICAgZnJhbWVPYmoubG9hZCgpO1xuICAgICAgfTtcblxuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBzcmMpO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gaGlkZShpbmRleCkge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcblxuICAgIGZyYW1lQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlKGluZGV4LCBjYWxsYmFjaykge1xuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcblxuICAgIF9jbGVhcihpbmRleCk7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIHJlbW92ZSB0aGUgaWZyYW1lIGJ5IGNsZWFyaW5nIGFsbCBlbGVtZW50cyBpbnNpZGUgZGl2IGNvbnRhaW5lclxuICAgICAgd2hpbGUgKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgZnJhbWVDb250YWluZXIucmVtb3ZlQ2hpbGQoZnJhbWVDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjYWxsYmFjayAmJiB0eXBlb2YgY2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH0sIDIwMCk7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93KGluZGV4KSB7XG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpO1xuXG4gICAgZnJhbWVDb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhZGQ6IGFkZCxcbiAgICBjcmVhdGVGcmFtZVBsYXllcjogY3JlYXRlRnJhbWVQbGF5ZXIsXG4gICAgZ2V0RnJhbWVDb250YWluZXI6IGdldEZyYW1lQ29udGFpbmVyLFxuICAgIGdldEZyYW1lT2JqZWN0OiBnZXRGcmFtZU9iamVjdCxcbiAgICBoaWRlOiBoaWRlLFxuICAgIHJlbW92ZTogcmVtb3ZlLFxuICAgIHNob3c6IHNob3dcbiAgfTtcbn07XG5cbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9seW1lclJlYWR5KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9seW1lci1yZWFkeVwiLCBwb2x5bWVyUmVhZHkpO1xuXG4gICAgaWYgKGlkICYmIGlkICE9PSBcIlwiKSB7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BsYXlfXCIgKyBpZCwgcGxheSk7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BhdXNlX1wiICsgaWQsIHBhdXNlKTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfc3RvcF9cIiArIGlkLCBzdG9wKTtcblxuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLnNldEFkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBbXCJhZGRpdGlvbmFsUGFyYW1zXCJdKTtcbiAgICB9XG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvbHltZXItcmVhZHlcIiwgcG9seW1lclJlYWR5KTtcblxufSkod2luZG93LCBnYWRnZXRzKTtcblxuXG5cbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktNCddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=