if("undefined"==typeof config){var config={};"undefined"!=typeof angular&&(angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","components/rv-common-i18n/dist/locales/translation_").constant("LOCALES_SUFIX",".json"),angular.module("risevision.widget.common.storage-selector.config").value("STORAGE_MODAL","http://storage.risevision.com/~rvi/storage-client-rva-test/storage-modal.html#/files/"))}var RiseVision=RiseVision||{};RiseVision.VideoFolder={},RiseVision.VideoFolder=function(e,t){"use strict";function n(){t.rpc.call("","rsevent_done",null,u.getString("id"))}function i(){t.rpc.call("","rsevent_ready",null,u.getString("id"),!0,!0,!0,!0,!0)}function o(){p=new RiseVision.VideoFolder.Slider(g),p.init()}function r(){p.pause()}function a(){p.play()}function s(n){u=new t.Prefs,g=n,g.width=u.getInt("rsW"),g.height=u.getInt("rsH"),e.getElementById("container").style.height=u.getInt("rsH")+"px",m=new RiseVision.Common.Background(g),m.init(o)}function c(){n()}function d(){i()}function l(){r()}var u=null,g={},m=null,p=null;return{pause:r,play:a,setAdditionalParams:s,sliderDone:c,sliderReady:d,stop:l}}(document,gadgets);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Background=function(e){"use strict";function t(){setTimeout(function(){c.style.backgroundImage="url("+e.background.image.url+g+"cb="+(new Date).getTime()+")",t()},l)}function n(){s=!0,e.background.useImage&&!u&&t(),a&&"function"==typeof a&&a()}function i(e){d.removeEventListener("rise-storage-response",i),c.style.backgroundImage=Array.isArray(e.detail)?"url("+e.detail[0]+")":"url("+e.detail+")",n()}function o(){var t;c=document.getElementById("background"),d=document.getElementById("backgroundStorage"),document.body.style.background=e.background.color,c?e.background.useImage?(c.className=e.background.image.position,c.className=e.background.image.scale?c.className+" scale-to-fit":c.className,u=0!==Object.keys(e.backgroundStorage).length,u?d?(d.addEventListener("rise-storage-response",i),d.setAttribute("folder",e.backgroundStorage.folder),d.setAttribute("fileName",e.backgroundStorage.fileName),d.setAttribute("companyId",e.backgroundStorage.companyId),d.go()):console.log("Missing element with id value of 'backgroundStorage'"):(t=e.background.image.url.split("?"),g=1===t.length?"?":"&",c.style.backgroundImage="url("+e.background.image.url+")",n())):n():console.log("Missing element with id value of 'background'")}function r(e){s?e&&"function"==typeof e&&e():(e&&(a=e),o())}var a=null,s=!1,c=null,d=null,l=9e5,u=!1,g="";return{init:r}};var RiseVision=RiseVision||{};RiseVision.VideoFolder=RiseVision.VideoFolder||{},RiseVision.VideoFolder.Slider=function(e){"use strict";function t(e){var t=null,n=e.substr(e.lastIndexOf(".")+1),i=n.split("?");return"undefined"!=typeof i[0]&&""!==i[0]&&(t=i[0],"ogv"===t&&(t="ogg")),t}function n(){var n=document.querySelector("#container ul"),i=document.createDocumentFragment(),o=[],r=null;l.forEach(function(n,i){var a=document.createElement("div"),s=document.createElement("video"),c=document.createElement("source");r=document.createElement("li"),r.setAttribute("class","panel"+(i+1)),a.setAttribute("class","video-container"),e.video.autoplay&&s.setAttribute("controls",""),s.volume=e.video.volume/100,c.setAttribute("type","video/"+t(n)),c.setAttribute("src",n),s.appendChild(c),a.appendChild(s),r.appendChild(a),o.push(r)}),o.forEach(function(e){i.appendChild(e)}),n.appendChild(i)}function i(e){var t={};switch(t.sort="",t.direction="",e){case"alpha-asc":t.sort="name",t.direction="asc";break;case"alpha-desc":t.sort="name",t.direction="desc";break;case"date-asc":t.sort="date",t.direction="asc";break;case"date-desc":t.sort="date",t.direction="desc";break;case"random":t.sort="random";break;default:t.sort="name",t.direction="asc"}return t}function o(e){var t=document.getElementById("container"),i=document.createDocumentFragment(),o=document.createElement("ul");o.setAttribute("id","slider"),i.appendChild(o),t.appendChild(i),l=e,n(),$("#slider").anythingSlider({expand:!0,autoPlay:!1,buildArrows:!0,buildStartStop:!1,buildNavigation:!1,appendForwardTo:null,appendBackTo:null}),g=$("#slider").data("AnythingSlider")}function r(){var t=i(e.order);d.addEventListener("rise-storage-response",function(e){u&&o(e.detail)}),d.setAttribute("companyId",e.storage.companyId),d.setAttribute("folder",e.storage.folder),d.setAttribute("sort",t.sort),d.setAttribute("sortDirection",t.direction),d.go()}function a(){u&&r()}function s(){}function c(){}var d=document.getElementById("videoFolderStorage"),l=null,u=!0,g=null;return{init:a,pause:s,play:c}},function(e,t){"use strict";function n(){RiseVision.VideoFolder.play()}function i(){RiseVision.VideoFolder.pause()}function o(){RiseVision.VideoFolder.stop()}function r(e,t){Array.isArray(e)&&e.length>0&&"additionalParams"===e[0]&&Array.isArray(t)&&t.length>0&&RiseVision.VideoFolder.setAdditionalParams(JSON.parse(t[0]))}var a=new t.Prefs,s=a.getString("id");e.oncontextmenu=function(){return!1},s&&""!==s&&(t.rpc.register("rscmd_play_"+s,n),t.rpc.register("rscmd_pause_"+s,i),t.rpc.register("rscmd_stop_"+s,o),t.rpc.register("rsparam_set_"+s,r),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-4"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwidmFsdWUiLCJSaXNlVmlzaW9uIiwiVmlkZW9Gb2xkZXIiLCJkb2N1bWVudCIsImdhZGdldHMiLCJfZG9uZSIsInJwYyIsImNhbGwiLCJfcHJlZnMiLCJnZXRTdHJpbmciLCJfcmVhZHkiLCJfYmFja2dyb3VuZFJlYWR5IiwiX3NsaWRlciIsIlNsaWRlciIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiaW5pdCIsInBhdXNlIiwicGxheSIsInNldEFkZGl0aW9uYWxQYXJhbXMiLCJwYXJhbXMiLCJQcmVmcyIsIndpZHRoIiwiZ2V0SW50IiwiaGVpZ2h0IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsIl9iYWNrZ3JvdW5kIiwiQ29tbW9uIiwiQmFja2dyb3VuZCIsInNsaWRlckRvbmUiLCJzbGlkZXJSZWFkeSIsInN0b3AiLCJkYXRhIiwiX3JlZnJlc2hUaW1lciIsInNldFRpbWVvdXQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJiYWNrZ3JvdW5kIiwiaW1hZ2UiLCJ1cmwiLCJfc2VwYXJhdG9yIiwiRGF0ZSIsImdldFRpbWUiLCJfcmVmcmVzaER1cmF0aW9uIiwidXNlSW1hZ2UiLCJfaXNTdG9yYWdlRmlsZSIsIl9jYWxsYmFjayIsIl9zdG9yYWdlUmVzcG9uc2UiLCJlIiwiX3N0b3JhZ2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiQXJyYXkiLCJpc0FycmF5IiwiZGV0YWlsIiwiX2NvbmZpZ3VyZSIsInN0ciIsImJvZHkiLCJjb2xvciIsImNsYXNzTmFtZSIsInBvc2l0aW9uIiwic2NhbGUiLCJPYmplY3QiLCJrZXlzIiwiYmFja2dyb3VuZFN0b3JhZ2UiLCJsZW5ndGgiLCJhZGRFdmVudExpc3RlbmVyIiwic2V0QXR0cmlidXRlIiwiZm9sZGVyIiwiZmlsZU5hbWUiLCJjb21wYW55SWQiLCJnbyIsImNvbnNvbGUiLCJsb2ciLCJzcGxpdCIsImNiIiwiX2dldFZpZGVvRmlsZVR5cGUiLCJ0eXBlIiwic3Vic3RyIiwibGFzdEluZGV4T2YiLCJhcnIiLCJfYWRkVmlkZW9zIiwibGlzdCIsInF1ZXJ5U2VsZWN0b3IiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpdGVtcyIsIml0ZW0iLCJfY3VycmVudFVybHMiLCJmb3JFYWNoIiwiaW5kZXgiLCJ2aWRlb0NvbnRhaW5lciIsImNyZWF0ZUVsZW1lbnQiLCJ2aWRlbyIsInNvdXJjZSIsImF1dG9wbGF5Iiwidm9sdW1lIiwiYXBwZW5kQ2hpbGQiLCJwdXNoIiwiX2dldFN0b3JhZ2VTb3J0Iiwib3JkZXIiLCJzb3J0IiwiZGlyZWN0aW9uIiwiX2NvbmZpZ3VyZVBsdWdpbiIsInVybHMiLCJjb250YWluZXIiLCJ1bCIsIiQiLCJhbnl0aGluZ1NsaWRlciIsImV4cGFuZCIsImF1dG9QbGF5IiwiYnVpbGRBcnJvd3MiLCJidWlsZFN0YXJ0U3RvcCIsImJ1aWxkTmF2aWdhdGlvbiIsImFwcGVuZEZvcndhcmRUbyIsImFwcGVuZEJhY2tUbyIsIl8kYXBpIiwiX2NvbmZpZ3VyZVN0b3JhZ2UiLCJzdG9yYWdlU29ydCIsIl9pbml0aWFsQnVpbGQiLCJzdG9yYWdlIiwid2luZG93IiwiYWRkaXRpb25hbFBhcmFtcyIsIm5hbWVzIiwidmFsdWVzIiwiSlNPTiIsInBhcnNlIiwicHJlZnMiLCJpZCIsIm9uY29udGV4dG1lbnUiLCJyZWdpc3RlciIsIl9nYXEiLCJnYSIsImFzeW5jIiwic3JjIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUVBLEdBQXNCLG1CQUFYQSxRQUF3QixDQUNqQyxHQUFJQSxVQUltQixvQkFBWkMsV0FDVEEsUUFBUUMsT0FBTyxvQ0FDWkMsU0FBUyxpQkFBa0IsdURBQzNCQSxTQUFTLGdCQUFpQixTQUU3QkYsUUFBUUMsT0FBTyxvREFDWkUsTUFBTSxn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QUFRRSxJQUFJMEgsU0FBUyxlQUFpQkYsRUFBSTlHLEdBQzFDWixFQUFRRSxJQUFJMEgsU0FBUyxjQUFnQkYsRUFBSS9GLEdBRXpDM0IsRUFBUUUsSUFBSTBILFNBQVMsZUFBaUJGLEVBQUlOLEdBQzFDcEgsRUFBUUUsSUFBSUMsS0FBSyxHQUFJLGNBQWUsS0FBTXVILEdBQUssdUJBR2hEUCxPQUFRbkgsUUFLWCxJQUFJNkgsTUFBT0EsUUFFWEEsTUFBS2pDLE1BQU0sY0FBZSxrQkFDMUJpQyxLQUFLakMsTUFBTSxtQkFFWCxXQUNFLEdBQUlrQyxHQUFLL0gsU0FBU3VGLGNBQWMsU0FBV3dDLEdBQUd2RCxLQUFPLGtCQUFtQnVELEVBQUdDLE9BQVEsRUFDbkZELEVBQUdFLEtBQU8sVUFBWWpJLFNBQVNrSSxTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJcEksU0FBU3FJLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFSLEVBQUlLIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgLy8gdmFyaWFibGVzIGdvIGhlcmVcbiAgfTtcblxuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBhbmd1bGFyLm1vZHVsZShcInJpc2V2aXNpb24uY29tbW9uLmkxOG4uY29uZmlnXCIsIFtdKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19QUkVGSVhcIiwgXCJjb21wb25lbnRzL3J2LWNvbW1vbi1pMThuL2Rpc3QvbG9jYWxlcy90cmFuc2xhdGlvbl9cIilcbiAgICAgIC5jb25zdGFudChcIkxPQ0FMRVNfU1VGSVhcIiwgXCIuanNvblwiKTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi53aWRnZXQuY29tbW9uLnN0b3JhZ2Utc2VsZWN0b3IuY29uZmlnXCIpXG4gICAgICAudmFsdWUoXCJTVE9SQUdFX01PREFMXCIsIFwiaHR0cDovL3N0b3JhZ2UucmlzZXZpc2lvbi5jb20vfnJ2aS9zdG9yYWdlLWNsaWVudC1ydmEtdGVzdC9zdG9yYWdlLW1vZGFsLmh0bWwjL2ZpbGVzL1wiKTtcbiAgfVxufVxuXG4vKiBnbG9iYWwgZ2FkZ2V0cyAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvRm9sZGVyID0ge307XG5cblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgPSAoZnVuY3Rpb24gKGRvY3VtZW50LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfcHJlZnMgPSBudWxsLFxuICAgIF9hZGRpdGlvbmFsUGFyYW1zID0ge30sXG4gICAgX2JhY2tncm91bmQgPSBudWxsLFxuICAgIF9zbGlkZXIgPSBudWxsO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9kb25lKCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X2RvbmVcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9iYWNrZ3JvdW5kUmVhZHkoKSB7XG4gICAgLy8gY3JlYXRlIGFuZCBpbml0aWFsaXplIHRoZSBQbGF5ZXIgaW5zdGFuY2VcbiAgICBfc2xpZGVyID0gbmV3IFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuU2xpZGVyKF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgICBfc2xpZGVyLmluaXQoKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgX3NsaWRlci5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBfc2xpZGVyLnBsYXkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMocGFyYW1zKSB7XG4gICAgX3ByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKTtcbiAgICBfYWRkaXRpb25hbFBhcmFtcyA9IHBhcmFtcztcbiAgICBfYWRkaXRpb25hbFBhcmFtcy53aWR0aCA9IF9wcmVmcy5nZXRJbnQoXCJyc1dcIik7XG4gICAgX2FkZGl0aW9uYWxQYXJhbXMuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKTtcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGFpbmVyXCIpLnN0eWxlLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIikgKyBcInB4XCI7XG5cbiAgICAvLyBjcmVhdGUgYW5kIGluaXRpYWxpemUgdGhlIEJhY2tncm91bmQgaW5zdGFuY2VcbiAgICBfYmFja2dyb3VuZCA9IG5ldyBSaXNlVmlzaW9uLkNvbW1vbi5CYWNrZ3JvdW5kKF9hZGRpdGlvbmFsUGFyYW1zKTtcbiAgICBfYmFja2dyb3VuZC5pbml0KF9iYWNrZ3JvdW5kUmVhZHkpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2xpZGVyRG9uZSgpIHtcbiAgICBfZG9uZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2xpZGVyUmVhZHkoKSB7XG4gICAgX3JlYWR5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIHBhdXNlKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwicGF1c2VcIjogcGF1c2UsXG4gICAgXCJwbGF5XCI6IHBsYXksXG4gICAgXCJzZXRBZGRpdGlvbmFsUGFyYW1zXCI6IHNldEFkZGl0aW9uYWxQYXJhbXMsXG4gICAgXCJzbGlkZXJEb25lXCI6IHNsaWRlckRvbmUsXG4gICAgXCJzbGlkZXJSZWFkeVwiOiBzbGlkZXJSZWFkeSxcbiAgICBcInN0b3BcIjogc3RvcFxuICB9O1xuXG59KShkb2N1bWVudCwgZ2FkZ2V0cyk7XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XG5cblJpc2VWaXNpb24uQ29tbW9uLkJhY2tncm91bmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2NhbGxiYWNrID0gbnVsbCxcbiAgICBfcmVhZHkgPSBmYWxzZSxcbiAgICBfYmFja2dyb3VuZCA9IG51bGwsXG4gICAgX3N0b3JhZ2UgPSBudWxsLFxuICAgIF9yZWZyZXNoRHVyYXRpb24gPSA5MDAwMDAsIC8vIDE1IG1pbnV0ZXNcbiAgICBfaXNTdG9yYWdlRmlsZSA9IGZhbHNlLFxuICAgIF9zZXBhcmF0b3IgPSBcIlwiO1xuXG4gIC8qXG4gICAqIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX3JlZnJlc2hUaW1lcigpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uIGJhY2tncm91bmRSZWZyZXNoKCkge1xuICAgICAgX2JhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBkYXRhLmJhY2tncm91bmQuaW1hZ2UudXJsICsgX3NlcGFyYXRvciArIFwiY2I9XCIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIFwiKVwiO1xuICAgICAgX3JlZnJlc2hUaW1lcigpO1xuICAgIH0sIF9yZWZyZXNoRHVyYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gX2JhY2tncm91bmRSZWFkeSgpIHtcbiAgICBfcmVhZHkgPSB0cnVlO1xuXG4gICAgaWYgKGRhdGEuYmFja2dyb3VuZC51c2VJbWFnZSAmJiAhX2lzU3RvcmFnZUZpbGUpIHtcbiAgICAgIC8vIHN0YXJ0IHRoZSByZWZyZXNoIHBvbGwgZm9yIG5vbi1zdG9yYWdlIGJhY2tncm91bmQgaW1hZ2VcbiAgICAgIF9yZWZyZXNoVGltZXIoKTtcbiAgICB9XG5cbiAgICBpZiAoX2NhbGxiYWNrICYmIHR5cGVvZiBfY2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgX2NhbGxiYWNrKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gX3N0b3JhZ2VSZXNwb25zZShlKSB7XG4gICAgX3N0b3JhZ2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBfc3RvcmFnZVJlc3BvbnNlKTtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KGUuZGV0YWlsKSkge1xuICAgICAgX2JhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBlLmRldGFpbFswXSArIFwiKVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBfYmFja2dyb3VuZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGUuZGV0YWlsICsgXCIpXCI7XG4gICAgfVxuICAgIF9iYWNrZ3JvdW5kUmVhZHkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9jb25maWd1cmUoKSB7XG4gICAgdmFyIHN0cjtcblxuICAgIF9iYWNrZ3JvdW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYWNrZ3JvdW5kXCIpO1xuICAgIF9zdG9yYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYWNrZ3JvdW5kU3RvcmFnZVwiKTtcblxuICAgIC8vIHNldCB0aGUgZG9jdW1lbnQgYmFja2dyb3VuZFxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuYmFja2dyb3VuZCA9IGRhdGEuYmFja2dyb3VuZC5jb2xvcjtcblxuICAgIGlmIChfYmFja2dyb3VuZCkge1xuICAgICAgaWYgKGRhdGEuYmFja2dyb3VuZC51c2VJbWFnZSkge1xuICAgICAgICBfYmFja2dyb3VuZC5jbGFzc05hbWUgPSBkYXRhLmJhY2tncm91bmQuaW1hZ2UucG9zaXRpb247XG4gICAgICAgIF9iYWNrZ3JvdW5kLmNsYXNzTmFtZSA9IGRhdGEuYmFja2dyb3VuZC5pbWFnZS5zY2FsZSA/IF9iYWNrZ3JvdW5kLmNsYXNzTmFtZSArIFwiIHNjYWxlLXRvLWZpdFwiXG4gICAgICAgICAgOiBfYmFja2dyb3VuZC5jbGFzc05hbWU7XG5cbiAgICAgICAgX2lzU3RvcmFnZUZpbGUgPSAoT2JqZWN0LmtleXMoZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZSkubGVuZ3RoICE9PSAwKTtcblxuICAgICAgICBpZiAoIV9pc1N0b3JhZ2VGaWxlKSB7XG4gICAgICAgICAgc3RyID0gZGF0YS5iYWNrZ3JvdW5kLmltYWdlLnVybC5zcGxpdChcIj9cIik7XG5cbiAgICAgICAgICAvLyBzdG9yZSB0aGlzIGZvciB0aGUgcmVmcmVzaCB0aW1lclxuICAgICAgICAgIF9zZXBhcmF0b3IgPSAoc3RyLmxlbmd0aCA9PT0gMSkgPyBcIj9cIiA6IFwiJlwiO1xuXG4gICAgICAgICAgX2JhY2tncm91bmQuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoXCIgKyBkYXRhLmJhY2tncm91bmQuaW1hZ2UudXJsICsgXCIpXCI7XG4gICAgICAgICAgX2JhY2tncm91bmRSZWFkeSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChfc3RvcmFnZSkge1xuICAgICAgICAgICAgLy8gUmlzZSBTdG9yYWdlXG4gICAgICAgICAgICBfc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIF9zdG9yYWdlUmVzcG9uc2UpO1xuXG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5mb2xkZXIpO1xuICAgICAgICAgICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZmlsZU5hbWVcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5maWxlTmFtZSk7XG4gICAgICAgICAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5iYWNrZ3JvdW5kU3RvcmFnZS5jb21wYW55SWQpO1xuICAgICAgICAgICAgX3N0b3JhZ2UuZ28oKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJNaXNzaW5nIGVsZW1lbnQgd2l0aCBpZCB2YWx1ZSBvZiAnYmFja2dyb3VuZFN0b3JhZ2UnXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX2JhY2tncm91bmRSZWFkeSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIk1pc3NpbmcgZWxlbWVudCB3aXRoIGlkIHZhbHVlIG9mICdiYWNrZ3JvdW5kJ1wiKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoY2IpIHtcbiAgICBpZiAoIV9yZWFkeSkge1xuICAgICAgaWYgKGNiKSB7XG4gICAgICAgIF9jYWxsYmFjayA9IGNiO1xuICAgICAgfVxuXG4gICAgICBfY29uZmlndXJlKCk7XG5cbiAgICB9IGVsc2UgaWYgKGNiICYmIHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBjYigpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJpbml0XCI6IGluaXRcbiAgfTtcbn07XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW9Gb2xkZXIgPSBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyIHx8IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvRm9sZGVyLlNsaWRlciA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Gb2xkZXJTdG9yYWdlXCIpLFxuICAgIF9jdXJyZW50VXJscyA9IG51bGwsXG4gICAgX2luaXRpYWxCdWlsZCA9IHRydWUsXG4gICAgXyRhcGkgPSBudWxsO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9nZXRWaWRlb0ZpbGVUeXBlKHVybCkge1xuICAgIHZhciB0eXBlID0gbnVsbCxcbiAgICAgIHN0ciA9IHVybC5zdWJzdHIodXJsLmxhc3RJbmRleE9mKFwiLlwiKSArIDEpLFxuICAgICAgYXJyID0gc3RyLnNwbGl0KFwiP1wiKTtcblxuICAgIGlmICh0eXBlb2YgYXJyWzBdICE9PSBcInVuZGVmaW5lZFwiICYmIGFyclswXSAhPT0gXCJcIikge1xuICAgICAgdHlwZSA9IGFyclswXTtcblxuICAgICAgaWYgKHR5cGUgPT09IFwib2d2XCIpIHtcbiAgICAgICAgdHlwZSA9IFwib2dnXCI7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cblxuICBmdW5jdGlvbiBfYWRkVmlkZW9zKCkge1xuICAgIHZhciBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb250YWluZXIgdWxcIiksXG4gICAgICBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcbiAgICAgIGl0ZW1zID0gW10sXG4gICAgICBpdGVtID0gbnVsbDtcblxuICAgIF9jdXJyZW50VXJscy5mb3JFYWNoKGZ1bmN0aW9uKHVybCwgaW5kZXgpIHtcbiAgICAgIHZhciB2aWRlb0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG4gICAgICAgIHZpZGVvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInZpZGVvXCIpLFxuICAgICAgICBzb3VyY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic291cmNlXCIpO1xuXG4gICAgICBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xuICAgICAgaXRlbS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInBhbmVsXCIgKyAoaW5kZXggKyAxKSk7XG5cbiAgICAgIHZpZGVvQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidmlkZW8tY29udGFpbmVyXCIpO1xuXG4gICAgICAvLyBUbyBiZSBjb25zaXN0ZW50IHdpdGggVmlkZW8gV2lkZ2V0LCBiYXNpbmcgdXNlIG9mIGNvbnRyb2xzIG9uIHVzZXIgc2VsZWN0aW9uIG9mIFwiQXV0b3BsYXlcIlxuICAgICAgaWYgKGRhdGEudmlkZW8uYXV0b3BsYXkpIHtcbiAgICAgICAgdmlkZW8uc2V0QXR0cmlidXRlKFwiY29udHJvbHNcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIHNldCBpbml0aWFsIHZvbHVtZSBvbiA8dmlkZW8+XG4gICAgICB2aWRlby52b2x1bWUgPSBkYXRhLnZpZGVvLnZvbHVtZSAvIDEwMDtcblxuICAgICAgLy8gc2V0IHRoZSBcInR5cGVcIiBhdHRyaWJ1dGUgb24gPHNvdXJjZT5cbiAgICAgIHNvdXJjZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidmlkZW8vXCIgKyBfZ2V0VmlkZW9GaWxlVHlwZSh1cmwpKTtcbiAgICAgIHNvdXJjZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdXJsKTtcblxuICAgICAgdmlkZW8uYXBwZW5kQ2hpbGQoc291cmNlKTtcbiAgICAgIHZpZGVvQ29udGFpbmVyLmFwcGVuZENoaWxkKHZpZGVvKTtcbiAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQodmlkZW9Db250YWluZXIpO1xuXG4gICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgIH0pO1xuXG4gICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICB9KTtcblxuICAgIGxpc3QuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2dldFN0b3JhZ2VTb3J0KG9yZGVyKSB7XG4gICAgdmFyIHZhbHVlID0ge307XG5cbiAgICB2YWx1ZS5zb3J0ID0gXCJcIjtcbiAgICB2YWx1ZS5kaXJlY3Rpb24gPSBcIlwiO1xuXG4gICAgc3dpdGNoIChvcmRlcikge1xuICAgICAgY2FzZSBcImFscGhhLWFzY1wiOlxuICAgICAgICB2YWx1ZS5zb3J0ID0gXCJuYW1lXCI7XG4gICAgICAgIHZhbHVlLmRpcmVjdGlvbiA9IFwiYXNjXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImFscGhhLWRlc2NcIjpcbiAgICAgICAgdmFsdWUuc29ydCA9IFwibmFtZVwiO1xuICAgICAgICB2YWx1ZS5kaXJlY3Rpb24gPSBcImRlc2NcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiZGF0ZS1hc2NcIjpcbiAgICAgICAgdmFsdWUuc29ydCA9IFwiZGF0ZVwiO1xuICAgICAgICB2YWx1ZS5kaXJlY3Rpb24gPSBcImFzY1wiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJkYXRlLWRlc2NcIjpcbiAgICAgICAgdmFsdWUuc29ydCA9IFwiZGF0ZVwiO1xuICAgICAgICB2YWx1ZS5kaXJlY3Rpb24gPSBcImRlc2NcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicmFuZG9tXCI6XG4gICAgICAgIHZhbHVlLnNvcnQgPSBcInJhbmRvbVwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHZhbHVlLnNvcnQgPSBcIm5hbWVcIjtcbiAgICAgICAgdmFsdWUuZGlyZWN0aW9uID0gXCJhc2NcIjtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICBmdW5jdGlvbiBfY29uZmlndXJlUGx1Z2luKHVybHMpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWluZXJcIiksXG4gICAgICBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcbiAgICAgIHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInVsXCIpO1xuXG4gICAgdWwuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJzbGlkZXJcIik7XG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodWwpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XG5cbiAgICBfY3VycmVudFVybHMgPSB1cmxzO1xuICAgIF9hZGRWaWRlb3MoKTtcblxuICAgICQoXCIjc2xpZGVyXCIpXG4gICAgICAuYW55dGhpbmdTbGlkZXIoe1xuICAgICAgICBleHBhbmQgICAgICAgOiB0cnVlLFxuICAgICAgICBhdXRvUGxheSAgICAgOiBmYWxzZSxcbiAgICAgICAgYnVpbGRBcnJvd3MgIDogdHJ1ZSxcbiAgICAgICAgYnVpbGRTdGFydFN0b3AgOiBmYWxzZSxcbiAgICAgICAgYnVpbGROYXZpZ2F0aW9uIDogZmFsc2UsXG4gICAgICAgIGFwcGVuZEZvcndhcmRUbyAgICAgOiBudWxsLFxuICAgICAgICBhcHBlbmRCYWNrVG8gICAgICAgIDogbnVsbFxuICAgICAgfSk7XG5cbiAgICBfJGFwaSA9ICQoXCIjc2xpZGVyXCIpLmRhdGEoXCJBbnl0aGluZ1NsaWRlclwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9jb25maWd1cmVTdG9yYWdlKCkge1xuICAgIHZhciBzdG9yYWdlU29ydCA9IF9nZXRTdG9yYWdlU29ydChkYXRhLm9yZGVyKTtcblxuICAgIF9zdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2UtcmVzcG9uc2VcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKF9pbml0aWFsQnVpbGQpIHtcbiAgICAgICAgX2NvbmZpZ3VyZVBsdWdpbihlLmRldGFpbCk7XG4gICAgICB9IC8qZWxzZSB7XG4gICAgICAgIC8vIFRPRE86IGhhbmRsZSBhIHJlZnJlc2hcbiAgICAgIH0qL1xuICAgIH0pO1xuXG4gICAgX3N0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEuc3RvcmFnZS5jb21wYW55SWQpO1xuICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLnN0b3JhZ2UuZm9sZGVyKTtcbiAgICBfc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJzb3J0XCIsIHN0b3JhZ2VTb3J0LnNvcnQpO1xuICAgIF9zdG9yYWdlLnNldEF0dHJpYnV0ZShcInNvcnREaXJlY3Rpb25cIiwgc3RvcmFnZVNvcnQuZGlyZWN0aW9uKTtcbiAgICBfc3RvcmFnZS5nbygpO1xuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBpbml0KCkge1xuICAgIGlmIChfaW5pdGlhbEJ1aWxkKSB7XG4gICAgICBfY29uZmlndXJlU3RvcmFnZSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuXG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuXG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiaW5pdFwiOiBpbml0LFxuICAgIFwicGF1c2VcIjogcGF1c2UsXG4gICAgXCJwbGF5XCI6IHBsYXlcbiAgfTtcbn07XG5cbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvRm9sZGVyLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkaXRpb25hbFBhcmFtcyhuYW1lcywgdmFsdWVzKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZXMpICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgbmFtZXNbMF0gPT09IFwiYWRkaXRpb25hbFBhcmFtc1wiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIFJpc2VWaXNpb24uVmlkZW9Gb2xkZXIuc2V0QWRkaXRpb25hbFBhcmFtcyhKU09OLnBhcnNlKHZhbHVlc1swXSkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChpZCAmJiBpZCAhPT0gXCJcIikge1xuICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BhdXNlX1wiICsgaWQsIHBhdXNlKTtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3N0b3BfXCIgKyBpZCwgc3RvcCk7XG5cbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzcGFyYW1fc2V0X1wiICsgaWQsIGFkZGl0aW9uYWxQYXJhbXMpO1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc3BhcmFtX2dldFwiLCBudWxsLCBpZCwgW1wiYWRkaXRpb25hbFBhcmFtc1wiXSk7XG4gIH1cblxufSkod2luZG93LCBnYWRnZXRzKTtcblxuXG5cbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktNCddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=