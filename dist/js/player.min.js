function init(e,t,n){window.oncontextmenu=function(){return!1},width=e.width,height=e.height,skin=n,controls=e.video.controls,volume=e.video.volume,autoPlay=e.video.autoplay,scaleToFit=e.video.scaleToFit,e.video.pause="string"==typeof e.video.pause?parseInt(e.video.pause,10):e.video.pause,pauseDuration="number"==typeof e.video.pause?e.video.pause:0,files=t,player=new PlayerJW,player.loadVideo()}function doneEvent(){parent.RiseVision.VideoFolder.playerEnded()}function readyEvent(){parent.RiseVision.VideoFolder.playerReady()}function errorEvent(e){parent.RiseVision.VideoFolder.playerError(e)}function play(){player.play()}function pause(){player.pause()}function stop(){player.stop()}function remove(){player.remove()}function getPlaybackData(){return{total:files.length,index:player.getCurrentIndex(),duration:player.getDuration(),position:player.getPosition()}}function PlayerJW(){function e(e){var t,n=[".mp4",".webm",".ogg",".ogv"],o=e.toLowerCase(),a=null;for(t=0;t<=n.length;t+=1)if(-1!==o.indexOf(n[t])){a=n[t].substr(n[t].lastIndexOf(".")+1);break}return"ogv"===a&&(a="ogg"),a}function t(){for(var t=[],n=0;n<files.length;n+=1)t.push({sources:[{file:files[n],type:e(files[n])}]});return t}function n(){doneEvent()}function o(){isLoading?(isLoading=!1,jwplayer().pause(),jwplayer().setMute(!1),jwplayer().setVolume(volume),controls&&!autoPlay&&jwplayer().setControls(!0),readyEvent()):(controls&&pauseDuration>1&&!pauseHandlerOn&&(pauseHandlerOn=!0,jwplayer().onPause(function(){a()})),clearTimeout(pauseTimer))}function a(){viewerPaused||isLoading||(clearTimeout(pauseTimer),pauseTimer=setTimeout(function(){jwplayer().play(),jwplayer().setControls(!1),jwplayer().setControls(!0)},1e3*pauseDuration))}function i(e){e&&errorEvent({type:"video",index:jwplayer().getPlaylistIndex(),message:e.message})}function r(e){e&&errorEvent({type:"setup",index:0,message:e.message})}this.loadVideo=function(){jwplayer("player").setup({playlist:t(),width:width,height:height,controls:!1,stretching:scaleToFit?"uniform":"none",skin:skin}),jwplayer().onSetupError(function(e){r(e)}),jwplayer().onReady(function(){var e,t=document.getElementById("player").getElementsByTagName("*"),a=t.length;for(e=0;a>e;e+=1)t[e].className+=" notransition";document.getElementById("player").className+=" notransition",jwplayer().onPlaylistComplete(function(){n()}),jwplayer().onPlay(function(){o()}),jwplayer().onError(function(e){i(e)}),setTimeout(function(){jwplayer().play()},200)})},this.play=function(){viewerPaused=!1,autoPlay&&(controls&&!jwplayer().getControls()&&jwplayer().setControls(!0),jwplayer().play(),controls&&(jwplayer().setControls(!1),jwplayer().setControls(!0)))},this.pause=function(){viewerPaused=!0,clearTimeout(pauseTimer),jwplayer().pause()},this.stop=function(){this.pause()},this.remove=function(){viewerPaused=!1,clearTimeout(pauseTimer),pauseTimer=null,jwplayer().remove()},this.getCurrentIndex=function(){return jwplayer().getPlaylistIndex()},this.getDuration=function(){return jwplayer().getDuration()},this.getPosition=function(){return jwplayer().getPosition()}}var files,controls,volume,autoPlay,scaleToFit,pauseDuration,width,height,skin,isLoading=!0,pauseHandlerOn=!1,viewerPaused=!1,pauseTimer=null,player=null;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3BsYXllci5taW4uanMiXSwibmFtZXMiOlsiaW5pdCIsInBhcmFtcyIsImxpc3QiLCJza2luVmFsIiwid2luZG93Iiwib25jb250ZXh0bWVudSIsIndpZHRoIiwiaGVpZ2h0Iiwic2tpbiIsImNvbnRyb2xzIiwidmlkZW8iLCJ2b2x1bWUiLCJhdXRvUGxheSIsImF1dG9wbGF5Iiwic2NhbGVUb0ZpdCIsInBhdXNlIiwicGFyc2VJbnQiLCJwYXVzZUR1cmF0aW9uIiwiZmlsZXMiLCJwbGF5ZXIiLCJQbGF5ZXJKVyIsImxvYWRWaWRlbyIsImRvbmVFdmVudCIsInBhcmVudCIsIlJpc2VWaXNpb24iLCJWaWRlb0ZvbGRlciIsInBsYXllckVuZGVkIiwicmVhZHlFdmVudCIsInBsYXllclJlYWR5IiwiZXJyb3JFdmVudCIsImRhdGEiLCJwbGF5ZXJFcnJvciIsInBsYXkiLCJzdG9wIiwicmVtb3ZlIiwiZ2V0UGxheWJhY2tEYXRhIiwidG90YWwiLCJsZW5ndGgiLCJpbmRleCIsImdldEN1cnJlbnRJbmRleCIsImR1cmF0aW9uIiwiZ2V0RHVyYXRpb24iLCJwb3NpdGlvbiIsImdldFBvc2l0aW9uIiwiZ2V0VmlkZW9GaWxlVHlwZSIsInVybCIsImkiLCJleHRlbnNpb25zIiwidXJsTG93ZXJjYXNlIiwidG9Mb3dlckNhc2UiLCJ0eXBlIiwiaW5kZXhPZiIsInN1YnN0ciIsImxhc3RJbmRleE9mIiwiZ2V0UGxheWxpc3QiLCJwbGF5bGlzdCIsInB1c2giLCJzb3VyY2VzIiwiZmlsZSIsIm9uUGxheWxpc3RDb21wbGV0ZSIsIm9uUGxheSIsImlzTG9hZGluZyIsImp3cGxheWVyIiwic2V0TXV0ZSIsInNldFZvbHVtZSIsInNldENvbnRyb2xzIiwicGF1c2VIYW5kbGVyT24iLCJvblBhdXNlIiwiY2xlYXJUaW1lb3V0IiwicGF1c2VUaW1lciIsInZpZXdlclBhdXNlZCIsInNldFRpbWVvdXQiLCJvblBsYXllckVycm9yIiwiZXJyb3IiLCJnZXRQbGF5bGlzdEluZGV4IiwibWVzc2FnZSIsIm9uU2V0dXBFcnJvciIsInRoaXMiLCJzZXR1cCIsInN0cmV0Y2hpbmciLCJvblJlYWR5IiwiZWxlbWVudHMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJjbGFzc05hbWUiLCJvbkVycm9yIiwiZ2V0Q29udHJvbHMiXSwibWFwcGluZ3MiOiJBQVlBLFFBQVNBLE1BQUtDLEVBQVFDLEVBQU1DLEdBQzFCQyxPQUFPQyxjQUFnQixXQUNyQixPQUFPLEdBR1RDLE1BQVFMLEVBQU9LLE1BQ2ZDLE9BQVNOLEVBQU9NLE9BQ2hCQyxLQUFPTCxFQUNQTSxTQUFXUixFQUFPUyxNQUFNRCxTQUN4QkUsT0FBU1YsRUFBT1MsTUFBTUMsT0FDdEJDLFNBQVdYLEVBQU9TLE1BQU1HLFNBQ3hCQyxXQUFhYixFQUFPUyxNQUFNSSxXQUcxQmIsRUFBT1MsTUFBTUssTUFBdUMsZ0JBQXZCZCxHQUFPUyxNQUFNSyxNQUFzQkMsU0FBU2YsRUFBT1MsTUFBTUssTUFBTyxJQUFNZCxFQUFPUyxNQUFNSyxNQUVoSEUsY0FBK0MsZ0JBQXZCaEIsR0FBT1MsTUFBTUssTUFBc0JkLEVBQU9TLE1BQU1LLE1BQVEsRUFFaEZHLE1BQVFoQixFQUVSaUIsT0FBUyxHQUFJQyxVQUNiRCxPQUFPRSxZQUdULFFBQVNDLGFBQ1BDLE9BQU9DLFdBQVdDLFlBQVlDLGNBR2hDLFFBQVNDLGNBQ1BKLE9BQU9DLFdBQVdDLFlBQVlHLGNBR2hDLFFBQVNDLFlBQVdDLEdBQ2xCUCxPQUFPQyxXQUFXQyxZQUFZTSxZQUFZRCxHQUc1QyxRQUFTRSxRQUNQYixPQUFPYSxPQUdULFFBQVNqQixTQUNQSSxPQUFPSixRQUdULFFBQVNrQixRQUNQZCxPQUFPYyxPQUdULFFBQVNDLFVBQ1BmLE9BQU9lLFNBR1QsUUFBU0MsbUJBQ1AsT0FDRUMsTUFBT2xCLE1BQU1tQixPQUNiQyxNQUFPbkIsT0FBT29CLGtCQUNkQyxTQUFVckIsT0FBT3NCLGNBQ2pCQyxTQUFVdkIsT0FBT3dCLGVBSXJC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QUl6QixPQUNBVCxTQUFVRSxPQUFRQyxTQUFVRSxXQUFZRyxjQUN4Q1gsTUFBT0MsT0FBUUMsS0FFZnFELFdBQVksRUFDZEssZ0JBQWlCLEVBRWZJLGNBQWUsRUFDZkQsV0FBYSxLQUVibEQsT0FBUyIsImZpbGUiOiJqcy9wbGF5ZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGZpbGVzO1xudmFyIGNvbnRyb2xzLCB2b2x1bWUsIGF1dG9QbGF5LCBzY2FsZVRvRml0LCBwYXVzZUR1cmF0aW9uO1xudmFyIHdpZHRoLCBoZWlnaHQsIHNraW47XG5cbnZhciBpc0xvYWRpbmcgPSB0cnVlLFxuICBwYXVzZUhhbmRsZXJPbiA9IGZhbHNlO1xuXG52YXIgdmlld2VyUGF1c2VkID0gZmFsc2U7XG52YXIgcGF1c2VUaW1lciA9IG51bGw7XG5cbnZhciBwbGF5ZXIgPSBudWxsO1xuXG5mdW5jdGlvbiBpbml0KHBhcmFtcywgbGlzdCwgc2tpblZhbCkge1xuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICB3aWR0aCA9IHBhcmFtcy53aWR0aDtcbiAgaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgc2tpbiA9IHNraW5WYWw7XG4gIGNvbnRyb2xzID0gcGFyYW1zLnZpZGVvLmNvbnRyb2xzO1xuICB2b2x1bWUgPSBwYXJhbXMudmlkZW8udm9sdW1lO1xuICBhdXRvUGxheSA9IHBhcmFtcy52aWRlby5hdXRvcGxheTtcbiAgc2NhbGVUb0ZpdCA9IHBhcmFtcy52aWRlby5zY2FsZVRvRml0O1xuXG4gIC8vIGNvbnZlcnQgcGF1c2UgdmFsdWUgdG8gbnVtYmVyIGlmIHR5cGUgaXMgXCJzdHJpbmdcIlxuICBwYXJhbXMudmlkZW8ucGF1c2UgPSAodHlwZW9mIHBhcmFtcy52aWRlby5wYXVzZSA9PT0gXCJzdHJpbmdcIikgPyBwYXJzZUludChwYXJhbXMudmlkZW8ucGF1c2UsIDEwKSA6IHBhcmFtcy52aWRlby5wYXVzZTtcbiAgLy8gaWYgbm90IG9mIHR5cGUgXCJudW1iZXJcIiwgc2V0IGl0cyB2YWx1ZSB0byAwIHNvIGEgcGF1c2UgZG9lcyBub3QgZ2V0IGFwcGxpZWRcbiAgcGF1c2VEdXJhdGlvbiA9ICh0eXBlb2YgcGFyYW1zLnZpZGVvLnBhdXNlID09PSBcIm51bWJlclwiKSA/IHBhcmFtcy52aWRlby5wYXVzZSA6IDA7XG5cbiAgZmlsZXMgPSBsaXN0O1xuXG4gIHBsYXllciA9IG5ldyBQbGF5ZXJKVygpO1xuICBwbGF5ZXIubG9hZFZpZGVvKCk7XG59XG5cbmZ1bmN0aW9uIGRvbmVFdmVudCgpIHtcbiAgcGFyZW50LlJpc2VWaXNpb24uVmlkZW9Gb2xkZXIucGxheWVyRW5kZWQoKTtcbn1cblxuZnVuY3Rpb24gcmVhZHlFdmVudCgpIHtcbiAgcGFyZW50LlJpc2VWaXNpb24uVmlkZW9Gb2xkZXIucGxheWVyUmVhZHkoKTtcbn1cblxuZnVuY3Rpb24gZXJyb3JFdmVudChkYXRhKSB7XG4gIHBhcmVudC5SaXNlVmlzaW9uLlZpZGVvRm9sZGVyLnBsYXllckVycm9yKGRhdGEpO1xufVxuXG5mdW5jdGlvbiBwbGF5KCkge1xuICBwbGF5ZXIucGxheSgpO1xufVxuXG5mdW5jdGlvbiBwYXVzZSgpIHtcbiAgcGxheWVyLnBhdXNlKCk7XG59XG5cbmZ1bmN0aW9uIHN0b3AoKSB7XG4gIHBsYXllci5zdG9wKCk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgcGxheWVyLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiBnZXRQbGF5YmFja0RhdGEoKSB7XG4gIHJldHVybiB7XG4gICAgdG90YWw6IGZpbGVzLmxlbmd0aCxcbiAgICBpbmRleDogcGxheWVyLmdldEN1cnJlbnRJbmRleCgpLFxuICAgIGR1cmF0aW9uOiBwbGF5ZXIuZ2V0RHVyYXRpb24oKSxcbiAgICBwb3NpdGlvbjogcGxheWVyLmdldFBvc2l0aW9uKClcbiAgfVxufVxuXG5mdW5jdGlvbiBQbGF5ZXJKVygpIHtcbiAgZnVuY3Rpb24gZ2V0VmlkZW9GaWxlVHlwZSh1cmwpIHtcbiAgICB2YXIgZXh0ZW5zaW9ucyA9IFtcIi5tcDRcIiwgXCIud2VibVwiLCBcIi5vZ2dcIiwgXCIub2d2XCJdLFxuICAgICAgdXJsTG93ZXJjYXNlID0gdXJsLnRvTG93ZXJDYXNlKCksXG4gICAgICB0eXBlID0gbnVsbCxcbiAgICAgIGk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDw9IGV4dGVuc2lvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIGlmICh1cmxMb3dlcmNhc2UuaW5kZXhPZihleHRlbnNpb25zW2ldKSAhPT0gLTEpIHtcbiAgICAgICAgdHlwZSA9IGV4dGVuc2lvbnNbaV0uc3Vic3RyKGV4dGVuc2lvbnNbaV0ubGFzdEluZGV4T2YoXCIuXCIpICsgMSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0eXBlID09PSBcIm9ndlwiKSB7XG4gICAgICB0eXBlID0gXCJvZ2dcIjtcbiAgICB9XG5cbiAgICByZXR1cm4gdHlwZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFBsYXlsaXN0KCkge1xuICAgIHZhciBwbGF5bGlzdCA9IFtdO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgcGxheWxpc3QucHVzaCh7XG4gICAgICAgIHNvdXJjZXM6IFt7XG4gICAgICAgICAgZmlsZTogZmlsZXNbaV0sXG4gICAgICAgICAgdHlwZTogZ2V0VmlkZW9GaWxlVHlwZShmaWxlc1tpXSlcbiAgICAgICAgfV1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwbGF5bGlzdDtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUGxheWxpc3RDb21wbGV0ZSgpIHtcbiAgICBkb25lRXZlbnQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUGxheSgpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICBpc0xvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgandwbGF5ZXIoKS5wYXVzZSgpO1xuICAgICAgandwbGF5ZXIoKS5zZXRNdXRlKGZhbHNlKTtcbiAgICAgIGp3cGxheWVyKCkuc2V0Vm9sdW1lKHZvbHVtZSk7XG5cbiAgICAgIGlmIChjb250cm9scyAmJiAhYXV0b1BsYXkpIHtcbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcbiAgICAgIH1cblxuICAgICAgcmVhZHlFdmVudCgpO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChjb250cm9scyAmJiBwYXVzZUR1cmF0aW9uID4gMSAmJiAhcGF1c2VIYW5kbGVyT24pIHtcbiAgICAgICAgcGF1c2VIYW5kbGVyT24gPSB0cnVlO1xuXG4gICAgICAgIC8vIG5vdyBkZWZpbmUgcGF1c2UgaGFuZGxlclxuICAgICAgICBqd3BsYXllcigpLm9uUGF1c2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIG9uUGF1c2UoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNsZWFyVGltZW91dChwYXVzZVRpbWVyKTtcbiAgICB9XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUGF1c2UoKSB7XG4gICAgaWYgKCF2aWV3ZXJQYXVzZWQgJiYgIWlzTG9hZGluZykge1xuICAgICAgLy8gdXNlciBoYXMgcGF1c2VkLCBzZXQgYSB0aW1lciB0byBwbGF5IGFnYWluXG4gICAgICBjbGVhclRpbWVvdXQocGF1c2VUaW1lcik7XG5cbiAgICAgIHBhdXNlVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBjb250aW51ZSBwbGF5aW5nIHRoZSBjdXJyZW50IHZpZGVvXG4gICAgICAgIGp3cGxheWVyKCkucGxheSgpO1xuXG4gICAgICAgIC8vIHdvcmthcm91bmQgZm9yIGNvbnRyb2xzIHJlbWFpbmluZyB2aXNpYmxlLCB0dXJuIHRoZW0gb2ZmIGFuZCBvbiBhZ2FpblxuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKGZhbHNlKTtcbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcblxuICAgICAgfSwgcGF1c2VEdXJhdGlvbiAqIDEwMDApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yRXZlbnQoe1xuICAgICAgICB0eXBlOiBcInZpZGVvXCIsXG4gICAgICAgIGluZGV4OiBqd3BsYXllcigpLmdldFBsYXlsaXN0SW5kZXgoKSxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25TZXR1cEVycm9yKGVycm9yKSB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBlcnJvckV2ZW50KHtcbiAgICAgICAgdHlwZTogXCJzZXR1cFwiLFxuICAgICAgICBpbmRleDogMCxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgdGhpcy5sb2FkVmlkZW8gPSBmdW5jdGlvbigpIHtcbiAgICBqd3BsYXllcihcInBsYXllclwiKS5zZXR1cCh7XG4gICAgICBwbGF5bGlzdDogZ2V0UGxheWxpc3QoKSxcbiAgICAgIHdpZHRoIDogd2lkdGgsXG4gICAgICBoZWlnaHQgOiBoZWlnaHQsXG4gICAgICBjb250cm9sczogZmFsc2UsXG4gICAgICBzdHJldGNoaW5nIDogc2NhbGVUb0ZpdCA/IFwidW5pZm9ybVwiIDogXCJub25lXCIsXG4gICAgICBza2luOiBza2luXG4gICAgfSk7XG5cbiAgICBqd3BsYXllcigpLm9uU2V0dXBFcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIG9uU2V0dXBFcnJvcihlcnJvcik7XG4gICAgfSk7XG5cbiAgICBqd3BsYXllcigpLm9uUmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIikuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpLFxuICAgICAgICB0b3RhbCA9IGVsZW1lbnRzLmxlbmd0aCxcbiAgICAgICAgaTtcblxuICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgQ2hyb21lIEFwcCBQbGF5ZXIgPHdlYnZpZXc+IG5vdCBoYW5kbGluZyBDU1MzIHRyYW5zaXRpb25cbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0b3RhbDsgaSArPSAxKSB7XG4gICAgICAgIGVsZW1lbnRzW2ldLmNsYXNzTmFtZSArPSBcIiBub3RyYW5zaXRpb25cIjtcbiAgICAgIH1cblxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIikuY2xhc3NOYW1lICs9IFwiIG5vdHJhbnNpdGlvblwiO1xuXG4gICAgICBqd3BsYXllcigpLm9uUGxheWxpc3RDb21wbGV0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9uUGxheWxpc3RDb21wbGV0ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIGp3cGxheWVyKCkub25QbGF5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb25QbGF5KCk7XG4gICAgICB9KTtcblxuICAgICAgandwbGF5ZXIoKS5vbkVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBvblBsYXllckVycm9yKGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gbmVlZCB0byB0ZXN0IGlmIHRoZXJlIGlzIGFuIGVycm9yIHBsYXlpbmcgZmlyc3QgdmlkZW9cbiAgICAgICAgandwbGF5ZXIoKS5wbGF5KCk7XG4gICAgICB9LCAyMDApO1xuXG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5wbGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgdmlld2VyUGF1c2VkID0gZmFsc2U7XG5cbiAgICBpZiAoYXV0b1BsYXkpIHtcbiAgICAgIGlmIChjb250cm9scyAmJiAhandwbGF5ZXIoKS5nZXRDb250cm9scygpKSB7XG4gICAgICAgIC8vIFdpbGwgYmUgZmlyc3QgdGltZSBwbGF5ZXIgaXMgYmVpbmcgdG9sZCB0byBwbGF5IHNvIGRvaW5nIHRoaXMgaGVyZSBhbmQgbm90IGluIHNldHVwIHNvIHRoYXQgY29udHJvbHNcbiAgICAgICAgLy8gYXJlbid0IHZpc2libGUgdXBvbiBwbGF5aW5nIGZvciB0aGUgZmlyc3QgdGltZS5cbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcbiAgICAgIH1cblxuICAgICAgandwbGF5ZXIoKS5wbGF5KCk7XG5cbiAgICAgIGlmIChjb250cm9scykge1xuICAgICAgICAvLyB3b3JrYXJvdW5kIGZvciBjb250cm9scyByZW1haW5pbmcgdmlzaWJsZSwgdHVybiB0aGVtIG9mZiBhbmQgb24gYWdhaW5cbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyhmYWxzZSk7XG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHModHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gIH07XG5cbiAgdGhpcy5wYXVzZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZpZXdlclBhdXNlZCA9IHRydWU7XG4gICAgY2xlYXJUaW1lb3V0KHBhdXNlVGltZXIpO1xuICAgIGp3cGxheWVyKCkucGF1c2UoKTtcbiAgfTtcblxuICB0aGlzLnN0b3AgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnBhdXNlKCk7XG4gIH07XG5cbiAgdGhpcy5yZW1vdmUgPSBmdW5jdGlvbigpIHtcbiAgICB2aWV3ZXJQYXVzZWQgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQocGF1c2VUaW1lcik7XG4gICAgcGF1c2VUaW1lciA9IG51bGw7XG4gICAgandwbGF5ZXIoKS5yZW1vdmUoKTtcbiAgfTtcblxuICB0aGlzLmdldEN1cnJlbnRJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBqd3BsYXllcigpLmdldFBsYXlsaXN0SW5kZXgoKTtcbiAgfTtcblxuICB0aGlzLmdldER1cmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBqd3BsYXllcigpLmdldER1cmF0aW9uKCk7XG4gIH07XG5cbiAgdGhpcy5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gandwbGF5ZXIoKS5nZXRQb3NpdGlvbigpO1xuICB9XG5cbn1cblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9