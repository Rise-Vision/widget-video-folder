function init(e,t,n){window.oncontextmenu=function(){return!1},width=e.width,height=e.height,skin=n,controls=e.video.controls,volume=e.video.volume,stretching=e.video.scaleToFit?"uniform":"none",autoPlay=controls?e.video.autoplay:!0,e.video.pause="string"==typeof e.video.pause?parseInt(e.video.pause,10):e.video.pause,pauseDuration=isNaN(e.video.pause)?0:e.video.pause,files=t,player=new PlayerJW}function load(){player.loadVideo()}function doneEvent(){window.parent!==window.top&&parent.RiseVision.VideoFolder.playerEnded()}function readyEvent(){window.parent!==window.top&&parent.RiseVision.VideoFolder.playerReady()}function errorEvent(e){window.parent!==window.top&&parent.RiseVision.VideoFolder.playerError(e)}function play(){player.play()}function pause(){player.pause()}function stop(){player.stop()}function remove(){player.remove()}function getPlaybackData(){return{total:files.length,index:player.getCurrentIndex(),duration:player.getDuration(),position:player.getPosition()}}function PlayerJW(){function e(){doneEvent()}function t(){r?(r=!1,jwplayer().pause(),jwplayer().setMute(!1),jwplayer().setVolume(volume),controls&&!autoPlay&&jwplayer().setControls(!0),readyEvent()):(controls&&pauseDuration>1&&!a&&(a=!0,jwplayer().onPause(function(){n()})),clearTimeout(s))}function n(){l||r||(clearTimeout(s),s=setTimeout(function(){jwplayer().play(),jwplayer().setControls(!1),jwplayer().setControls(!0)},1e3*pauseDuration))}function o(e){e&&errorEvent({type:"video",index:jwplayer().getPlaylistIndex(),message:e.message})}function i(e){e&&errorEvent({type:"setup",index:0,message:e.message})}var r=!0,a=!1,l=!1,s=null;this.getVideoFileType=function(e){var t,n=[".mp4",".webm",".ogg",".ogv"],o=e.toLowerCase(),i=null;for(t=0;t<=n.length;t+=1)if(-1!==o.indexOf(n[t])){i=n[t].substr(n[t].lastIndexOf(".")+1);break}return"ogv"===i&&(i="ogg"),i},this.getPlaylist=function(e){for(var t=[],n=0;n<e.length;n+=1)t.push({sources:[{file:e[n],type:this.getVideoFileType(e[n])}]});return t},this.loadVideo=function(){jwplayer("player").setup({playlist:this.getPlaylist(files),width:width,height:height,controls:!1,stretching:stretching,skin:skin}),jwplayer().onSetupError(function(e){i(e)}),jwplayer().onReady(function(){var n,i=document.getElementById("player").getElementsByTagName("*"),r=i.length;for(n=0;r>n;n+=1)i[n].className+=" notransition";document.getElementById("player").className+=" notransition",jwplayer().onPlaylistComplete(function(){e()}),jwplayer().onPlay(function(){t()}),jwplayer().onError(function(e){o(e)}),setTimeout(function(){jwplayer().play()},200)})},this.play=function(){l=!1,autoPlay&&(controls&&!jwplayer().getControls()&&jwplayer().setControls(!0),jwplayer().play(),controls&&(jwplayer().setControls(!1),jwplayer().setControls(!0)))},this.pause=function(){l=!0,clearTimeout(s),jwplayer().pause()},this.stop=function(){this.pause()},this.remove=function(){l=!1,clearTimeout(s),s=null,jwplayer().remove()},this.getCurrentIndex=function(){return jwplayer().getPlaylistIndex()},this.getDuration=function(){return jwplayer().getDuration()},this.getPosition=function(){return jwplayer().getPosition()}}var files,controls,volume,autoPlay,stretching,pauseDuration,width,height,skin,player=null;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3BsYXllci5taW4uanMiXSwibmFtZXMiOlsiaW5pdCIsInBhcmFtcyIsImxpc3QiLCJza2luVmFsIiwid2luZG93Iiwib25jb250ZXh0bWVudSIsIndpZHRoIiwiaGVpZ2h0Iiwic2tpbiIsImNvbnRyb2xzIiwidmlkZW8iLCJ2b2x1bWUiLCJzdHJldGNoaW5nIiwiYXV0b1BsYXkiLCJhdXRvcGxheSIsInBhdXNlIiwicGFyc2VJbnQiLCJwYXVzZUR1cmF0aW9uIiwiaXNOYU4iLCJmaWxlcyIsInBsYXllciIsIlBsYXllckpXIiwibG9hZCIsImxvYWRWaWRlbyIsImRvbmVFdmVudCIsInBhcmVudCIsInRvcCIsIlJpc2VWaXNpb24iLCJWaWRlb0ZvbGRlciIsInBsYXllckVuZGVkIiwicmVhZHlFdmVudCIsInBsYXllclJlYWR5IiwiZXJyb3JFdmVudCIsImRhdGEiLCJwbGF5ZXJFcnJvciIsInBsYXkiLCJzdG9wIiwicmVtb3ZlIiwiZ2V0UGxheWJhY2tEYXRhIiwidG90YWwiLCJsZW5ndGgiLCJpbmRleCIsImdldEN1cnJlbnRJbmRleCIsImR1cmF0aW9uIiwiZ2V0RHVyYXRpb24iLCJwb3NpdGlvbiIsImdldFBvc2l0aW9uIiwib25QbGF5bGlzdENvbXBsZXRlIiwib25QbGF5IiwiaXNMb2FkaW5nIiwiandwbGF5ZXIiLCJzZXRNdXRlIiwic2V0Vm9sdW1lIiwic2V0Q29udHJvbHMiLCJwYXVzZUhhbmRsZXJPbiIsIm9uUGF1c2UiLCJjbGVhclRpbWVvdXQiLCJwYXVzZVRpbWVyIiwidmlld2VyUGF1c2VkIiwic2V0VGltZW91dCIsIm9uUGxheWVyRXJyb3IiLCJlcnJvciIsInR5cGUiLCJnZXRQbGF5bGlzdEluZGV4IiwibWVzc2FnZSIsIm9uU2V0dXBFcnJvciIsInRoaXMiLCJnZXRWaWRlb0ZpbGVUeXBlIiwidXJsIiwiaSIsImV4dGVuc2lvbnMiLCJ1cmxMb3dlcmNhc2UiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJzdWJzdHIiLCJsYXN0SW5kZXhPZiIsImdldFBsYXlsaXN0IiwicGxheWxpc3QiLCJwdXNoIiwic291cmNlcyIsImZpbGUiLCJzZXR1cCIsIm9uUmVhZHkiLCJlbGVtZW50cyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImNsYXNzTmFtZSIsIm9uRXJyb3IiLCJnZXRDb250cm9scyJdLCJtYXBwaW5ncyI6IkFBTUEsUUFBU0EsTUFBS0MsRUFBUUMsRUFBTUMsR0FDMUJDLE9BQU9DLGNBQWdCLFdBQ3JCLE9BQU8sR0FHVEMsTUFBUUwsRUFBT0ssTUFDZkMsT0FBU04sRUFBT00sT0FDaEJDLEtBQU9MLEVBQ1BNLFNBQVdSLEVBQU9TLE1BQU1ELFNBQ3hCRSxPQUFTVixFQUFPUyxNQUFNQyxPQUN0QkMsV0FBY1gsRUFBT1MsTUFBZ0IsV0FBSSxVQUFZLE9BR3JERyxTQUFhSixTQUFtQlIsRUFBT1MsTUFBTUksVUFBcEIsRUFFekJiLEVBQU9TLE1BQU1LLE1BQXVDLGdCQUF2QmQsR0FBT1MsTUFBTUssTUFBc0JDLFNBQVNmLEVBQU9TLE1BQU1LLE1BQU8sSUFBTWQsRUFBT1MsTUFBTUssTUFHaEhFLGNBQWlCQyxNQUFNakIsRUFBT1MsTUFBTUssT0FBVSxFQUFJZCxFQUFPUyxNQUFNSyxNQUUvREksTUFBUWpCLEVBRVJrQixPQUFTLEdBQUlDLFVBR2YsUUFBU0MsUUFDUEYsT0FBT0csWUFHVCxRQUFTQyxhQUNIcEIsT0FBT3FCLFNBQVdyQixPQUFPc0IsS0FDM0JELE9BQU9FLFdBQVdDLFlBQVlDLGNBSWxDLFFBQVNDLGNBQ0gxQixPQUFPcUIsU0FBV3JCLE9BQU9zQixLQUMzQkQsT0FBT0UsV0FBV0MsWUFBWUcsY0FJbEMsUUFBU0MsWUFBV0MsR0FDZDdCLE9BQU9xQixTQUFXckIsT0FBT3NCLEtBQzNCRCxPQUFPRSxXQUFXQyxZQUFZTSxZQUFZRCxHQUk5QyxRQUFTRSxRQUNQZixPQUFPZSxPQUdULFFBQVNwQixTQUNQSyxPQUFPTCxRQUdULFFBQVNxQixRQUNQaEIsT0FBT2dC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V0FDVjhCLEtBQUtuRCxTQUdQbUQsS0FBSzdCLE9BQVMsV0FDWnFCLEdBQWUsRUFDZkYsYUFBYUMsR0FDYkEsRUFBYSxLQUNiUCxXQUFXYixVQUdiNkIsS0FBS3hCLGdCQUFrQixXQUNyQixNQUFPUSxZQUFXYSxvQkFHcEJHLEtBQUt0QixZQUFjLFdBQ2pCLE1BQU9NLFlBQVdOLGVBR3BCc0IsS0FBS3BCLFlBQWMsV0FDakIsTUFBT0ksWUFBV0osZUEzUnRCLEdBQUkzQixPQUNBVixTQUFVRSxPQUFRRSxTQUFVRCxXQUFZSyxjQUN4Q1gsTUFBT0MsT0FBUUMsS0FFZlksT0FBUyIsImZpbGUiOiJqcy9wbGF5ZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGZpbGVzO1xudmFyIGNvbnRyb2xzLCB2b2x1bWUsIGF1dG9QbGF5LCBzdHJldGNoaW5nLCBwYXVzZUR1cmF0aW9uO1xudmFyIHdpZHRoLCBoZWlnaHQsIHNraW47XG5cbnZhciBwbGF5ZXIgPSBudWxsO1xuXG5mdW5jdGlvbiBpbml0KHBhcmFtcywgbGlzdCwgc2tpblZhbCkge1xuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICB3aWR0aCA9IHBhcmFtcy53aWR0aDtcbiAgaGVpZ2h0ID0gcGFyYW1zLmhlaWdodDtcbiAgc2tpbiA9IHNraW5WYWw7XG4gIGNvbnRyb2xzID0gcGFyYW1zLnZpZGVvLmNvbnRyb2xzO1xuICB2b2x1bWUgPSBwYXJhbXMudmlkZW8udm9sdW1lO1xuICBzdHJldGNoaW5nID0gKHBhcmFtcy52aWRlby5zY2FsZVRvRml0KSA/IFwidW5pZm9ybVwiIDogXCJub25lXCI7XG5cbiAgLy8gZW5zdXJlIGF1dG9QbGF5IGlzIHRydWUgaWYgY29udHJvbHMgdmFsdWUgaXMgZmFsc2UsIG90aGVyd2lzZSB1c2UgcGFyYW1zIHZhbHVlXG4gIGF1dG9QbGF5ID0gKCFjb250cm9scykgPyB0cnVlIDogcGFyYW1zLnZpZGVvLmF1dG9wbGF5O1xuICAvLyBjb252ZXJ0IHBhdXNlIHZhbHVlIHRvIG51bWJlciBpZiB0eXBlIGlzIFwic3RyaW5nXCJcbiAgcGFyYW1zLnZpZGVvLnBhdXNlID0gKHR5cGVvZiBwYXJhbXMudmlkZW8ucGF1c2UgPT09IFwic3RyaW5nXCIpID8gcGFyc2VJbnQocGFyYW1zLnZpZGVvLnBhdXNlLCAxMCkgOiBwYXJhbXMudmlkZW8ucGF1c2U7XG5cbiAgLy8gaWYgbm90IG9mIHR5cGUgXCJudW1iZXJcIiwgc2V0IGl0cyB2YWx1ZSB0byAwIHNvIGEgcGF1c2UgZG9lcyBub3QgZ2V0IGFwcGxpZWRcbiAgcGF1c2VEdXJhdGlvbiA9IChpc05hTihwYXJhbXMudmlkZW8ucGF1c2UpKSA/IDAgOiBwYXJhbXMudmlkZW8ucGF1c2U7XG5cbiAgZmlsZXMgPSBsaXN0O1xuXG4gIHBsYXllciA9IG5ldyBQbGF5ZXJKVygpO1xufVxuXG5mdW5jdGlvbiBsb2FkKCkge1xuICBwbGF5ZXIubG9hZFZpZGVvKCk7XG59XG5cbmZ1bmN0aW9uIGRvbmVFdmVudCgpIHtcbiAgaWYgKHdpbmRvdy5wYXJlbnQgIT09IHdpbmRvdy50b3ApIHtcbiAgICBwYXJlbnQuUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5wbGF5ZXJFbmRlZCgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlYWR5RXZlbnQoKSB7XG4gIGlmICh3aW5kb3cucGFyZW50ICE9PSB3aW5kb3cudG9wKSB7XG4gICAgcGFyZW50LlJpc2VWaXNpb24uVmlkZW9Gb2xkZXIucGxheWVyUmVhZHkoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlcnJvckV2ZW50KGRhdGEpIHtcbiAgaWYgKHdpbmRvdy5wYXJlbnQgIT09IHdpbmRvdy50b3ApIHtcbiAgICBwYXJlbnQuUmlzZVZpc2lvbi5WaWRlb0ZvbGRlci5wbGF5ZXJFcnJvcihkYXRhKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwbGF5KCkge1xuICBwbGF5ZXIucGxheSgpO1xufVxuXG5mdW5jdGlvbiBwYXVzZSgpIHtcbiAgcGxheWVyLnBhdXNlKCk7XG59XG5cbmZ1bmN0aW9uIHN0b3AoKSB7XG4gIHBsYXllci5zdG9wKCk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgcGxheWVyLnJlbW92ZSgpO1xufVxuXG5mdW5jdGlvbiBnZXRQbGF5YmFja0RhdGEoKSB7XG4gIHJldHVybiB7XG4gICAgdG90YWw6IGZpbGVzLmxlbmd0aCxcbiAgICBpbmRleDogcGxheWVyLmdldEN1cnJlbnRJbmRleCgpLFxuICAgIGR1cmF0aW9uOiBwbGF5ZXIuZ2V0RHVyYXRpb24oKSxcbiAgICBwb3NpdGlvbjogcGxheWVyLmdldFBvc2l0aW9uKClcbiAgfVxufVxuXG5mdW5jdGlvbiBQbGF5ZXJKVygpIHtcbiAgdmFyIGlzTG9hZGluZyA9IHRydWUsXG4gICAgcGF1c2VIYW5kbGVyT24gPSBmYWxzZSxcbiAgICB2aWV3ZXJQYXVzZWQgPSBmYWxzZTtcblxuICB2YXIgcGF1c2VUaW1lciA9IG51bGw7XG5cbiAgZnVuY3Rpb24gb25QbGF5bGlzdENvbXBsZXRlKCkge1xuICAgIGRvbmVFdmVudCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25QbGF5KCkge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIGlzTG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICBqd3BsYXllcigpLnBhdXNlKCk7XG4gICAgICBqd3BsYXllcigpLnNldE11dGUoZmFsc2UpO1xuICAgICAgandwbGF5ZXIoKS5zZXRWb2x1bWUodm9sdW1lKTtcblxuICAgICAgaWYgKGNvbnRyb2xzICYmICFhdXRvUGxheSkge1xuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKHRydWUpO1xuICAgICAgfVxuXG4gICAgICByZWFkeUV2ZW50KCk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGNvbnRyb2xzICYmIHBhdXNlRHVyYXRpb24gPiAxICYmICFwYXVzZUhhbmRsZXJPbikge1xuICAgICAgICBwYXVzZUhhbmRsZXJPbiA9IHRydWU7XG5cbiAgICAgICAgLy8gbm93IGRlZmluZSBwYXVzZSBoYW5kbGVyXG4gICAgICAgIGp3cGxheWVyKCkub25QYXVzZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgb25QYXVzZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgY2xlYXJUaW1lb3V0KHBhdXNlVGltZXIpO1xuICAgIH1cblxuICB9XG5cbiAgZnVuY3Rpb24gb25QYXVzZSgpIHtcbiAgICBpZiAoIXZpZXdlclBhdXNlZCAmJiAhaXNMb2FkaW5nKSB7XG4gICAgICAvLyB1c2VyIGhhcyBwYXVzZWQsIHNldCBhIHRpbWVyIHRvIHBsYXkgYWdhaW5cbiAgICAgIGNsZWFyVGltZW91dChwYXVzZVRpbWVyKTtcblxuICAgICAgcGF1c2VUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGNvbnRpbnVlIHBsYXlpbmcgdGhlIGN1cnJlbnQgdmlkZW9cbiAgICAgICAgandwbGF5ZXIoKS5wbGF5KCk7XG5cbiAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IgY29udHJvbHMgcmVtYWluaW5nIHZpc2libGUsIHR1cm4gdGhlbSBvZmYgYW5kIG9uIGFnYWluXG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHMoZmFsc2UpO1xuICAgICAgICBqd3BsYXllcigpLnNldENvbnRyb2xzKHRydWUpO1xuXG4gICAgICB9LCBwYXVzZUR1cmF0aW9uICogMTAwMCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25QbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgZXJyb3JFdmVudCh7XG4gICAgICAgIHR5cGU6IFwidmlkZW9cIixcbiAgICAgICAgaW5kZXg6IGp3cGxheWVyKCkuZ2V0UGxheWxpc3RJbmRleCgpLFxuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBvblNldHVwRXJyb3IoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGVycm9yRXZlbnQoe1xuICAgICAgICB0eXBlOiBcInNldHVwXCIsXG4gICAgICAgIGluZGV4OiAwLFxuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICB0aGlzLmdldFZpZGVvRmlsZVR5cGUgPSBmdW5jdGlvbiAodXJsKSB7XG4gICAgdmFyIGV4dGVuc2lvbnMgPSBbXCIubXA0XCIsIFwiLndlYm1cIiwgXCIub2dnXCIsIFwiLm9ndlwiXSxcbiAgICAgIHVybExvd2VyY2FzZSA9IHVybC50b0xvd2VyQ2FzZSgpLFxuICAgICAgdHlwZSA9IG51bGwsXG4gICAgICBpO1xuXG4gICAgZm9yIChpID0gMDsgaSA8PSBleHRlbnNpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICBpZiAodXJsTG93ZXJjYXNlLmluZGV4T2YoZXh0ZW5zaW9uc1tpXSkgIT09IC0xKSB7XG4gICAgICAgIHR5cGUgPSBleHRlbnNpb25zW2ldLnN1YnN0cihleHRlbnNpb25zW2ldLmxhc3RJbmRleE9mKFwiLlwiKSArIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodHlwZSA9PT0gXCJvZ3ZcIikge1xuICAgICAgdHlwZSA9IFwib2dnXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHR5cGU7XG4gIH07XG5cbiAgdGhpcy5nZXRQbGF5bGlzdCA9IGZ1bmN0aW9uIChsaXN0KSB7XG4gICAgdmFyIHBsYXlsaXN0ID0gW107XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHBsYXlsaXN0LnB1c2goe1xuICAgICAgICBzb3VyY2VzOiBbe1xuICAgICAgICAgIGZpbGU6IGxpc3RbaV0sXG4gICAgICAgICAgdHlwZTogdGhpcy5nZXRWaWRlb0ZpbGVUeXBlKGxpc3RbaV0pXG4gICAgICAgIH1dXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGxheWxpc3Q7XG4gIH07XG5cbiAgdGhpcy5sb2FkVmlkZW8gPSBmdW5jdGlvbigpIHtcbiAgICBqd3BsYXllcihcInBsYXllclwiKS5zZXR1cCh7XG4gICAgICBwbGF5bGlzdDogdGhpcy5nZXRQbGF5bGlzdChmaWxlcyksXG4gICAgICB3aWR0aCA6IHdpZHRoLFxuICAgICAgaGVpZ2h0IDogaGVpZ2h0LFxuICAgICAgY29udHJvbHM6IGZhbHNlLFxuICAgICAgc3RyZXRjaGluZyA6IHN0cmV0Y2hpbmcsXG4gICAgICBza2luOiBza2luXG4gICAgfSk7XG5cbiAgICBqd3BsYXllcigpLm9uU2V0dXBFcnJvcihmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIG9uU2V0dXBFcnJvcihlcnJvcik7XG4gICAgfSk7XG5cbiAgICBqd3BsYXllcigpLm9uUmVhZHkoZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIikuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpLFxuICAgICAgICB0b3RhbCA9IGVsZW1lbnRzLmxlbmd0aCxcbiAgICAgICAgaTtcblxuICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgQ2hyb21lIEFwcCBQbGF5ZXIgPHdlYnZpZXc+IG5vdCBoYW5kbGluZyBDU1MzIHRyYW5zaXRpb25cbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0b3RhbDsgaSArPSAxKSB7XG4gICAgICAgIGVsZW1lbnRzW2ldLmNsYXNzTmFtZSArPSBcIiBub3RyYW5zaXRpb25cIjtcbiAgICAgIH1cblxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIikuY2xhc3NOYW1lICs9IFwiIG5vdHJhbnNpdGlvblwiO1xuXG4gICAgICBqd3BsYXllcigpLm9uUGxheWxpc3RDb21wbGV0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9uUGxheWxpc3RDb21wbGV0ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIGp3cGxheWVyKCkub25QbGF5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb25QbGF5KCk7XG4gICAgICB9KTtcblxuICAgICAgandwbGF5ZXIoKS5vbkVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBvblBsYXllckVycm9yKGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gbmVlZCB0byB0ZXN0IGlmIHRoZXJlIGlzIGFuIGVycm9yIHBsYXlpbmcgZmlyc3QgdmlkZW9cbiAgICAgICAgandwbGF5ZXIoKS5wbGF5KCk7XG4gICAgICB9LCAyMDApO1xuXG4gICAgfSk7XG4gIH07XG5cbiAgdGhpcy5wbGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgdmlld2VyUGF1c2VkID0gZmFsc2U7XG5cbiAgICBpZiAoYXV0b1BsYXkpIHtcbiAgICAgIGlmIChjb250cm9scyAmJiAhandwbGF5ZXIoKS5nZXRDb250cm9scygpKSB7XG4gICAgICAgIC8vIFdpbGwgYmUgZmlyc3QgdGltZSBwbGF5ZXIgaXMgYmVpbmcgdG9sZCB0byBwbGF5IHNvIGRvaW5nIHRoaXMgaGVyZSBhbmQgbm90IGluIHNldHVwIHNvIHRoYXQgY29udHJvbHNcbiAgICAgICAgLy8gYXJlbid0IHZpc2libGUgdXBvbiBwbGF5aW5nIGZvciB0aGUgZmlyc3QgdGltZS5cbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyh0cnVlKTtcbiAgICAgIH1cblxuICAgICAgandwbGF5ZXIoKS5wbGF5KCk7XG5cbiAgICAgIGlmIChjb250cm9scykge1xuICAgICAgICAvLyB3b3JrYXJvdW5kIGZvciBjb250cm9scyByZW1haW5pbmcgdmlzaWJsZSwgdHVybiB0aGVtIG9mZiBhbmQgb24gYWdhaW5cbiAgICAgICAgandwbGF5ZXIoKS5zZXRDb250cm9scyhmYWxzZSk7XG4gICAgICAgIGp3cGxheWVyKCkuc2V0Q29udHJvbHModHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gIH07XG5cbiAgdGhpcy5wYXVzZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZpZXdlclBhdXNlZCA9IHRydWU7XG4gICAgY2xlYXJUaW1lb3V0KHBhdXNlVGltZXIpO1xuICAgIGp3cGxheWVyKCkucGF1c2UoKTtcbiAgfTtcblxuICB0aGlzLnN0b3AgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnBhdXNlKCk7XG4gIH07XG5cbiAgdGhpcy5yZW1vdmUgPSBmdW5jdGlvbigpIHtcbiAgICB2aWV3ZXJQYXVzZWQgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQocGF1c2VUaW1lcik7XG4gICAgcGF1c2VUaW1lciA9IG51bGw7XG4gICAgandwbGF5ZXIoKS5yZW1vdmUoKTtcbiAgfTtcblxuICB0aGlzLmdldEN1cnJlbnRJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBqd3BsYXllcigpLmdldFBsYXlsaXN0SW5kZXgoKTtcbiAgfTtcblxuICB0aGlzLmdldER1cmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBqd3BsYXllcigpLmdldER1cmF0aW9uKCk7XG4gIH07XG5cbiAgdGhpcy5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gandwbGF5ZXIoKS5nZXRQb3NpdGlvbigpO1xuICB9XG5cbn1cblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9